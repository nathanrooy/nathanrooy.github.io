<html lang=en><head><meta charset=utf-8><title>Nathan Rooy</title><meta content="Nathan Rooy" name=author><meta content=en name=language><meta content="width=device-width,minimum-scale=1" name=viewport><meta content=nathan.fun property=og:site_name><meta content=nathan.fun property=twitter:domain><meta content=article property=og:type><meta content=https://nathan.fun/posts/2023-04-12/visual-book-recommender/ property=og:url><meta content=https://nathan.fun/posts/2023-04-12/visual-book-recommender/ name=twitter:url><meta content="Nathan A. Rooy" name=copyright><meta content=summary_large_image name=twitter:card><meta content="book recommendations,deep learning,contrastive learning,contrastive loss,latent space,tsne,t-SNE" name=keywords><meta content="A visual book recommender" name=twitter:title><meta content="A visual book recommender" property=og:title><meta content="Recreating the used bookstore experience via contrastive learning, t-SNE, and 100M book reviews." name=description><meta content="Recreating the used bookstore experience via contrastive learning, t-SNE, and 100M book reviews." name=twitter:description><meta content="Recreating the used bookstore experience via contrastive learning, t-SNE, and 100M book reviews." property=og:description><meta content=https://nathan.fun/posts/2023-04-12/visual-book-recommender/imgs-web/og-img-1200x630.jpg name=twitter:image><meta content=https://nathan.fun/posts/2023-04-12/visual-book-recommender/imgs-web/og-img-1200x630.jpg property=og:image><meta content=https://nathan.fun/posts/2023-04-12/visual-book-recommender/imgs-web/og-img-1200x630.jpg name=thumbnail><link title="Nathan Rooy" href=https://nathan.fun/index.xml rel=alternate type=application/rss+xml><link href=/favicon/favicon.png rel=icon type=image/png><link as=font crossorigin href=/fonts/figtree-v1-latin-regular.woff2 rel=preload type=font/woff2><link href=https://nathan.fun/posts/2023-04-12/visual-book-recommender/ rel=canonical><link href=https://raw.githubusercontent.com/nathanrooy/feedly-opml-archiver/refs/heads/main/feedly.opml rel=blogroll type=text/xml><script data-domain=nathan.fun defer src=https://plausible.io/js/script.tagged-events.js></script><style>:root{--main-text-color:#222;--main-text-weight:400;--text-bold:600;--font-family:"Figtree",sans-serif;--background-light:#f5f5f5;--link-text-color:#0955b5;--dark-text-color:#999}html{font-size:16px}body{-webkit-font-smoothing:antialiased;font-family:var(--font-family);color:var(--main-text-color);font-weight:var(--main-text-weight)}.wrapper{max-width:660px;margin:6rem auto 0;padding:1rem}@media only screen and (width<=750px){.wrapper{margin-top:2.5rem;margin-left:0}}a{color:var(--link-text-color);text-decoration:none}::selection{text-shadow:none;background:#fff9c4}img{max-width:100%;margin:1.5em auto;display:block}@font-face{font-family:Figtree;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/figtree-v1-latin-regular.eot);src:local(""),url(/fonts/figtree-v1-latin-regular.eot?#iefix)format("embedded-opentype"),url(/fonts/figtree-v1-latin-regular.woff2)format("woff2"),url(/fonts/figtree-v1-latin-regular.woff)format("woff"),url(/fonts/figtree-v1-latin-regular.ttf)format("truetype"),url(/fonts/figtree-v1-latin-regular.svg#Figtree)format("svg")}@font-face{font-family:Figtree;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/figtree-v1-latin-600.eot);src:local(""),url(/fonts/figtree-v1-latin-600.eot?#iefix)format("embedded-opentype"),url(/fonts/figtree-v1-latin-600.woff2)format("woff2"),url(/fonts/figtree-v1-latin-600.woff)format("woff"),url(/fonts/figtree-v1-latin-600.ttf)format("truetype"),url(/fonts/figtree-v1-latin-600.svg#Figtree)format("svg")}.wrapper{padding-bottom:8rem}p{letter-spacing:.01rem;word-spacing:.025rem;margin:0 0 1rem;font-size:1rem;line-height:1.7rem}h1{font-weight:var(--main-text-weight);color:var(--main-text-color);font-size:2.3rem;line-height:2.64rem}h2{font-size:1.2rem;font-weight:var(--text-bold);margin-bottom:.3em}*+h2{padding-top:2rem}ul{padding-left:15px;list-style:inside}ul li{margin-bottom:.5rem}hr{height:1px;color:var(--main-text-color);background-color:var(--main-text-color);border:none;margin:4rem 0}@media only screen and (width>=751px){#burger{padding-top:2rem;padding-left:2rem}}@media only screen and (width<=750px){#burger{padding-top:1rem;padding-left:1rem}}#burger{font-family:var(--font-family);color:#a9a9a9;font-size:1.5rem;font-weight:400}#burger a{padding-right:.8rem;display:inline-block}#burger label{cursor:pointer}#nav-icons{padding-left:.8rem}#nav-icons svg{max-height:20px;color:var(--main-text-color);margin-bottom:-.05rem}#l1-val{position:relative;top:-.12rem}#l2-val{padding-left:.1rem;padding-right:.1rem;position:relative;top:-.2rem}#burger-cbox{display:none}#label-1{display:inline-block}#label-2,#burger-cbox:not(:checked)~#nav-icons{display:none}.post .post-header{margin-bottom:2.5rem}.post .post-header .title{margin:0}</style></head><body><div class=header><nav><div id=burger><input id=burger-cbox type=checkbox><label for=burger-cbox id=label-1><span>[</span><span id=l1-val>+</span><span>]</span></label><label for=burger-cbox id=label-2><span>[</span><span id=l2-val>x</span><span>]</span></label><div id=nav-icons><a class="plausible-event-name=burger+home" aria-label=Home href=/ style=padding-right:.7rem><svg class="feather feather-home" viewbox="0 0 24 24" fill=none height=24 id=home-icon stroke=currentcolor stroke-linecap=round stroke-linejoin=round stroke-width=1 width=24><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></a><a class="plausible-event-name=burger+reading" aria-label=Reading href=/reading><svg viewbox="0 0 23.809855 18.892912" height=24 id=svg5 width=24><defs id=defs2></defs><g id=layer1 transform=translate(-6.352941,-30.26865)><g id=g39 transform=matrix(0.26458333,0,0,0.26458333,5.0300244,26.48677)><path d="m92.22 22.9v59C74.24 76.35 61.26 78.85 54.73 81.04 59.2 76.64 68.54 70.55 84.16 74.14l1.69.39V21.42c2.17.29 4.3.77 6.37 1.48z" class=st0 id=path11></path><path d="M45.24 81.04C38.73 78.85 25.74 76.35 7.77 81.9v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.96 2.5 29.42 6.9z" class=st0 id=path13></path><polygon points="48.86,85.63 48.82,85.58 48.91,85.63" id=polygon15></polygon><polygon points="51.17,85.58 51.13,85.63 50,85.63 51.09,85.62" id=polygon17></polygon><path d="m94.09 20.63c-2.68-1-5.45-1.65-8.24-2.02v-2.94l-1.08-.24c-17.8-4.09-28.32 3.81-32.9 8.68-.81.87-1.44 1.63-1.88 2.22C49.54 25.74 48.91 24.98 48.1 24.11c-4.58-4.87-15.11-12.76-32.9-8.68l-1.07.24v2.94c-2.8.38-5.57 1.02-8.24 2.02L5 20.97V85.7l1.81-.61c13.49-4.49 24.13-4.16 30.68-3.08 7.09 1.15 11.05 3.4 11.09 3.42l.23.14.09.06H50l1.09-.01.08-.05.23-.14c.05-.02 4-2.27 11.09-3.42 6.55-1.08 17.19-1.41 30.68 3.08l1.82.61V20.97zM7.78 81.89v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.95 2.5 29.42 6.9-6.52-2.18-19.5-4.68-37.47.86zm40.76-1.3c-4.19-4.66-14.29-12.83-31.63-9.5v-53.2c11.11-2.28 18.93.38 24.02 3.66 2.6 1.68 4.48 3.52 5.71 4.95 1.14 1.32 1.73 2.28 1.82 2.43l.08.15zm2.76.17V29.34l.24-.4c.09-.16.68-1.12 1.82-2.44 1.23-1.43 3.11-3.27 5.71-4.94 5.08-3.29 12.91-5.95 24.02-3.67v53.2C65.54 67.72 55.4 76.13 51.3 80.76zm40.92 1.13C74.24 76.34 61.26 78.84 54.73 81.03 59.2 76.63 68.54 70.54 84.16 74.13l1.69.39v-53.1c2.16.29 4.3.77 6.37 1.48z" id=path19></path></g></g><style id=style9>.st0{fill:none}</style></svg> </a><a aria-label="NYC Bike Exploring" class="plausible-event-name=burger+nycbike" href=/bike-exploring/nyc style=margin-left:.4rem><svg viewbox="0 0 91.5 52.5" height=24 width=32><g transform=matrix(-1,0,0,1,95.8,-23.9)><path d="m78 40.6c-3.8.0-7.3 1.2-10.2 3.2l-7.4-9.4 2.9-8.5H67c.6.0 1-.4 1-1s-.4-1-1-1H54.8c-.6.0-1 .4-1 1s.4 1 1 1h6.3l-2.3 6.7c-.2-.2-.4-.3-.7-.3H32l2.2-6.4h5.7c.6.0 1-.4 1-1s-.4-1-1-1h-6.4c-.4.0-.8.3-.9.7l-5.7 16.8c-1.5-.4-3.1-.7-4.8-.7-9.8.0-17.8 8-17.8 17.8s8 17.8 17.8 17.8 17.8-8 17.8-17.8c0-7.5-4.6-13.9-11.2-16.5l2.6-7.6 19 24.4c.1.3.3.6.6.7.1.0.2.1.3.1h.1 8.9c.5 9.4 8.3 16.8 17.8 16.8 9.8.0 17.8-8 17.8-17.8s-8-18-17.8-18zM37.8 58.4c0 8.7-7.1 15.8-15.8 15.8S6.2 67.1 6.2 58.4 13.3 42.6 22 42.6c1.4.0 2.8.2 4.1.6L21 58.1c-.2.5.1 1.1.6 1.3.1.0.2.1.3.1.4.0.8-.3.9-.7l5.1-14.9c5.9 2.2 9.9 7.9 9.9 14.5zm29.7-11.8L76 57.4H62.2c.3-4.3 2.2-8.1 5.3-10.8zm-16.7 9.6-17.1-22h24l.4.5zm1.8 1.2 7.1-20.8 6.6 8.4c-3.5 3.1-5.7 7.4-6 12.4zM78 74.2c-8.4.0-15.2-6.6-15.8-14.8H78c.4.0.7-.2.9-.6.2-.3.1-.8-.1-1.1L69 45.4c2.5-1.8 5.6-2.8 8.9-2.8 8.7.0 15.8 7.1 15.8 15.8s-7 15.8-15.7 15.8z"></path></g></svg></a><a class="plausible-event-name=burger+about" aria-label=About href=/about><svg class="feather feather-user" viewbox="0 0 24 24" fill=none height=24 id=about-icon stroke=currentcolor stroke-linecap=round stroke-linejoin=round stroke-width=1 width=24><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"></path><circle cx=12 cy=7 r=4></circle></svg> </a><a class="plausible-event-name=burger+rss" aria-label=RSS href=/index.xml><svg class="feather feather-rss" viewbox="0 0 30 24" fill=none height=24 id=rss-icon stroke=#444 stroke-linecap=round stroke-linejoin=round stroke-width=1.5 width=24><path d="M4 11a9 9 0 019 9"></path><path d="M4 4a16 16 0 0116 16"></path><circle cx=5 cy=19 r=1></circle></svg></a></div></div></nav></div><div class="wrapper post"><div class=post-header><h1 class=title>A visual book recommender</h1></div><hr><div class=markdown><h2>Introduction</h2><p>I have this long running conjecture that used book stores are superior to commercial book outlets (including Amazon) for discovering books. One of the reasons for this I think has less to do with a skewed explore/exploit strategy, and more to do with the way exploratory suggestions are sourced. I think financial pressure skews exploratory search suggestions towards oversampling newer books rather than older adjacent books. I get that though; oversampling newer books is a simple way to help combat the rich getting richer trap. The problem is that I’m biased against new books; I think they’re mostly noise. Used books stores on the other hand are curated by humans for other humans (who probably live nearby). If I ask for a book that’s like “x” they’re not going to point me to the newer version of “x”, they’re going to show me books “y” and “z”. There are additional reasons that go beyond just oversampling newer books which I’ll touch on later. I’ll also admit that all the supporting evidence I have is completely anecdotal, but still, when I want a new book I don’t pull out my phone, I walk down the street to the used book store.</p><h2>First attempt</h2><p>I’ve been casually thinking about how a book recommender could reflect the used book store experience for a while now. This first attempt is still a bit rough around the edges, but I think it captures some of what I’m after. It initially started out as roughly 100M book reviews that were then distilled into basic reading preferences. I then rode the Pareto frontier between latent representation and model accuracy for about a month before I landed on what you see below. Books closer together indicate a stronger favorability. Enjoy! (make sure to go click the full screen button)</p><div id=map style=background-color:#000><input alt="book search icon" id=search-button onclick=reveal_search() src=search.svg style=z-index:1000;background-color:#fff;border-radius:2px;width:22px;height:22px;padding:4px;position:absolute;top:130px;left:12px type=image><div id=search-box style=z-index:1000;display:none;position:absolute;top:130px;left:50px><input id=search placeholder=Search... size=40><ul id=suggestions style=margin-left:7px;display:none></ul></div></div><h2>Genre clusters</h2><p>I think one of the key drivers fueling the high discovery rate at used book stores has to do with the layout. All of my favorite used book stores are located in old buildings that have lots of nooks and crannies. It’s this fractal approach to book layout that I think encourages exploration into areas you wouldn’t explicitly seek out otherwise. This “nooks and crannies” feeling was a major attribute I was trying to recreate with this first iteration.</p><p>Below, you’ll find a selection of the most common genres. Each book and its assigned genre are represented once as a single point. Keep in mind that the model has absolutely no understanding of authors, genres, book descriptions, vocabulary, or plot lines. It simply knows which books people liked more than others. Each cluster represents a collection of books which have a higher than expected favorability amongst a subset of readers. A large genre such as Science-fiction can include many clusters each representing a different pocket of interest within that genre. A genre that consists of one cluster with sharp, well defined borders (such as Romanian-literature or Christian-fiction) indicates a readership with more focused interests.</p><img alt="book genre scatter plot" class=img-with-border id=genre-img src=imgs-web/genre-clusters/comics.png><div id=genre-container><div onclick='change_img("adventure")' class=genre-block id=adventure>Adventure</div><div onclick='change_img("african-american")' class=genre-block id=african-american>African-american</div><div onclick='change_img("aliens")' class=genre-block id=aliens>Aliens</div><div onclick='change_img("alternate-history")' class=genre-block id=alternate-history>Alternate-history</div><div onclick='change_img("amish")' class=genre-block id=amish>Amish</div><div onclick='change_img("angels")' class=genre-block id=angels>Angels</div><div onclick='change_img("art")' class=genre-block id=art>Art</div><div onclick='change_img("bdsm")' class=genre-block id=bdsm>Bdsm</div><div onclick='change_img("biography")' class=genre-block id=biography>Biography</div><div onclick='change_img("buddhism")' class=genre-block id=buddhism>Buddhism</div><div onclick='change_img("business")' class=genre-block id=business>Business</div><div onclick='change_img("chick-lit")' class=genre-block id=chick-lit>Chick-lit</div><div onclick='change_img("childrens")' class=genre-block id=childrens>Childrens</div><div onclick='change_img("christian")' class=genre-block id=christian>Christian</div><div onclick='change_img("christian-fiction")' class=genre-block id=christian-fiction>Christian-fiction</div><div onclick='change_img("christmas")' class=genre-block id=christmas>Christmas</div><div onclick='change_img("classics")' class=genre-block id=classics>Classics</div><div onclick='change_img("comics")' class=genre-block id=comics>Comics</div><div onclick='change_img("cookbooks")' class=genre-block id=cookbooks>Cookbooks</div><div onclick='change_img("crime")' class=genre-block id=crime>Crime</div><div onclick='change_img("dark")' class=genre-block id=dark>Dark</div><div onclick='change_img("dystopia")' class=genre-block id=dystopia>Dystopia</div><div onclick='change_img("economics")' class=genre-block id=economics>Economics</div><div onclick='change_img("erotica")' class=genre-block id=erotica>Erotica</div><div onclick='change_img("fantasy")' class=genre-block id=fantasy>Fantasy</div><div onclick='change_img("fiction")' class=genre-block id=fiction>Fiction</div><div onclick='change_img("finance")' class=genre-block id=finance>Finance</div><div onclick='change_img("graphic-novels")' class=genre-block id=graphic-novels>Graphic-novels</div><div onclick='change_img("health")' class=genre-block id=health>Health</div><div onclick='change_img("historical-fiction")' class=genre-block id=historical-fiction>Historical-fiction</div><div onclick='change_img("historical-romance")' class=genre-block id=historical-romance>Historical-romance</div><div onclick='change_img("history")' class=genre-block id=history>History</div><div onclick='change_img("horror")' class=genre-block id=horror>Horror</div><div onclick='change_img("horses")' class=genre-block id=horses>Horses</div><div onclick='change_img("humor")' class=genre-block id=humor>Humor</div><div onclick='change_img("leadership")' class=genre-block id=leadership>Leadership</div><div onclick='change_img("m-m-romance")' class=genre-block id=m-m-romance>M-m-romance</div><div onclick='change_img("manga")' class=genre-block id=manga>Manga</div><div onclick='change_img("marriage")' class=genre-block id=marriage>Marriage</div><div onclick='change_img("memoir")' class=genre-block id=memoir>Memoir</div><div onclick='change_img("middle-grade")' class=genre-block id=middle-grade>Middle-grade</div><div onclick='change_img("music")' class=genre-block id=music>Music</div><div onclick='change_img("mystery")' class=genre-block id=mystery>Mystery</div><div onclick='change_img("new-adult")' class=genre-block id=new-adult>New-adult</div><div onclick='change_img("non-fiction")' class=genre-block id=non-fiction>Non-fiction</div><div onclick='change_img("novels")' class=genre-block id=novels>Novels</div><div onclick='change_img("paranormal-romance")' class=genre-block id=paranormal-romance>Paranormal-romance</div><div onclick='change_img("paranormal")' class=genre-block id=paranormal>Paranormal</div><div onclick='change_img("philosophy")' class=genre-block id=philosophy>Philosophy</div><div onclick='change_img("picture-books")' class=genre-block id=picture-books>Picture-books</div><div onclick='change_img("plays")' class=genre-block id=plays>Plays</div><div onclick='change_img("poetry")' class=genre-block id=poetry>Poetry</div><div onclick='change_img("programming")' class=genre-block id=programming>Programming</div><div onclick='change_img("psychology")' class=genre-block id=psychology>Psychology</div><div onclick='change_img("realistic-fiction")' class=genre-block id=realistic-fiction>Realistic-fiction</div><div onclick='change_img("reverse-harem")' class=genre-block id=reverse-harem>Reverse-harem</div><div onclick='change_img("romance")' class=genre-block id=romance>Romance</div><div onclick='change_img("romanian-literature")' class=genre-block id=romanian-literature>Romanian-literature</div><div onclick='change_img("romantic-suspense")' class=genre-block id=romantic-suspense>Romantic-suspense</div><div onclick='change_img("russia")' class=genre-block id=russia>Russian</div><div onclick='change_img("science-fiction")' class=genre-block id=science-fiction>Science-fiction</div><div onclick='change_img("science")' class=genre-block id=science>Science</div><div onclick='change_img("self-help")' class=genre-block id=self-help>Self-help</div><div onclick='change_img("shapeshifters")' class=genre-block id=shapeshifters>Shapeshifters</div><div onclick='change_img("spirituality")' class=genre-block id=spirituality>Spirituality</div><div onclick='change_img("sports-romance")' class=genre-block id=sports-romance>Sports-romance</div><div onclick='change_img("sports")' class=genre-block id=sports>Sports</div><div onclick='change_img("star-wars")' class=genre-block id=star-wars>Star-wars</div><div onclick='change_img("steampunk")' class=genre-block id=steampunk>Steampunk</div><div onclick='change_img("theology")' class=genre-block id=theology>Theology</div><div onclick='change_img("thriller")' class=genre-block id=thriller>Thriller</div><div onclick='change_img("time-travel")' class=genre-block id=time-travel>Time-travel</div><div onclick='change_img("true-crime")' class=genre-block id=true-crime>True-crime</div><div onclick='change_img("turkish-literature")' class=genre-block id=turkish-literature>Turkish-literature</div><div onclick='change_img("urban-fantasy")' class=genre-block id=urban-fantasy>Urban-fantasy</div><div onclick='change_img("vampires")' class=genre-block id=vampires>Vampires</div><div onclick='change_img("westerns")' class=genre-block id=westerns>Westerns</div><div onclick='change_img("witchcraft")' class=genre-block id=witchcraft>Witchcraft</div><div onclick='change_img("young-adult")' class=genre-block id=young-adult>Young-adult</div><div onclick='change_img("zombies")' class=genre-block id=zombies>Zombies</div></div><p>In most clustering situations, crisp, well defined borders are the desired outcome. Points which fall outside of these boundaries are usually seen as a nuisance (customer segmentation amiright?). In this particular situation though, the books which fall between multiple clusters actually represent something rather interesting. They’re books that strongly capture multiple readerships (or they capture a smaller, more diffused readership).</p><h2>Technical details</h2><p>A few years ago, I scraped a little over 100M book reviews spread across 505k unique users and 6.97M books. In order to reduce the potential influence of spam reviews I took the following measures:</p><ul><li>Only include books with 100 reviews or more.</li><li>Only include reviews which came from users who had at least 10 reviews.</li><li>Only include users who had reviews spread across a minimum time window of 6 months.</li></ul><p>After filtering, the total review count dropped down to 26.8M across 396k users and 59k books. Since many of these books were in fact just different editions of the same book, they were consolidated into their canonical version represented by the edition with the most reviews. This brought the final count to 51,847 books.</p><p>The model itself is just a basic siamese network with a contrastive loss. I had initially implemented a <a href=https://en.wikipedia.org/wiki/Triplet_loss>triplet loss</a> which yielded good model performance but the embeddings lacked the aesthetic qualities I was after. After some tinkering, I ended up simplifying it down to the pairwise contrastive loss you see below:</p><img alt="contrastive loss" class=svg-equation src=imgs-web/contrastive_loss.svg><p>We can clearly see that this loss contains two distinct forces trying to overcome each other. If we establish <em>d</em> as the euclidean distance between the latent representations of two books <em>x<sub>i</sub></em> and <em>x<sub>j</sub></em>, then y=0 represents two books in close proximity with each other while y=1 are two books further apart. With the bounds established, the forces become apparent.</p><img alt="push and pull forces in contrastive loss" class=svg-equation src=imgs-web/push_and_pull.svg><p>With these two competing forces shuffling books around, the next question becomes: <em>how do we want to define similarity?</em> I actually tested about a dozen different strategies and ended up using the <a href=https://en.wikipedia.org/wiki/Pointwise_mutual_information>pointwise mutual information</a> shared between books.</p><img alt="formula for determining the pointwise mutual information between two books" class=svg-equation src=imgs-web/pmi.svg><p>High PMI scores are produced when the joint probability of liking two books <em>a</em> and <em>b</em> exceeds the expected probability of liking those same two books assuming independence. Now it’s just a matter of computing these distributions, but in order to do so we now need to define <em>like</em> and <em>dislike</em>… Well I hate to disappoint:</p><img alt="pointwise mutual information frequency" class=svg-equation src=imgs-web/pmi_frequency.svg><p>Not only was this the very first thing I tried, and after testing maybe twenty variants (this includes model training too!) it was still producing the best embeddings. I know, what a letdown… Now the original question of <em>similarity</em> can be resolved with the following:</p><img alt="ground truth assumption" class=svg-equation src=imgs-web/y_true.svg><p>With everything defined, the filtered 26.8M reviews were expanded into just over 300M pair-wise training rows. Each book was represented by a one-hot encoded array (1x51847) and compressed into a 64D latent space by the model. To further accentuate the clusters, instead of running through each training row per epoch, I sampled rows proportional to the combined (book a + book b) review count frequency. After model training, the 64D book vectors were further compressed down to 2D via t-SNE. The output of which can be seen below.</p><img alt="book vector latent embeddings t-sne output" loading=lazy src=imgs-web/tsne.png><p>Because t-SNE doesn’t care about overlapping points I needed a way to both remove the overlap and add some padding around the book covers. The script I wrote to accomplish this iteratively moves the book covers while also producing these oddly satisfying animations…</p><img alt="iterative book cover movement animation" class=img-with-border loading=lazy src=imgs-web/book-displacement.gif><h2 id=thoughts-on-v20>Thoughts on v2.0</h2><p>My favorite books fall within the intersection of engineering and adventure. Not “engineering” as a subject, but rather from the <em>perspective</em> of the engineers. My favorite book of all time, Skunkworks by Ben Rich captures this beautifully. The fact that Skunkworks hasn’t been made into a movie in the style of the <em>The Big Short</em> blows my mind. Anyway, books like Apollo (Charles Murray & Catherine Cox), The Descent (Brad Matsen), The Fastest Men on Earth (Paul Clifton), and The First Crossing of the Polar Sea (Roald Amundsen) are other great books in this area. But since aerospace engineering doesn’t have a whole lot of overlap with deep sea exploration, I never get served these recommendations online. Thank goodness for <a href=https://www.ohiobookstore.net/>The Ohio Book Store</a>!</p><p>Anyway, I’ve been experimenting with the idea of long tail book recommendations and fuzzy vectors and the initial results have me really excited. I just want more serendipitous book suggestions!</p><div id=footer-v2><center><p style=word-spacing:.3rem><a class="plausible-event-name=footer+home" href=/>Home</a> | <a class="plausible-event-name=footer+about" href=/about>About</a> | <a class="plausible-event-name=footer+rss" href=/index.xml>RSS</a></p></center></div><script>const change_img=e=>{x=document.getElementById("genre-img"),x.src="imgs-web/genre-clusters/"+e+".png";var t=document.getElementById("genre-container").querySelectorAll("div");for(let n=0;n<t.length;n++)t[n].id==e?t[n].style.backgroundColor="red":t[n].style.backgroundColor=""};change_img("comics")</script><style>.book-desc p{font-size:.9rem;line-height:1.2rem}#map{width:100%;height:450px;margin-top:1.5rem}#footer-v2{padding-top:10rem}#footer-v2 a{color:var(--main-text-color)}.markdown{padding-bottom:4rem}.img-with-border{border:1px solid #000}.genre-block{text-align:left;cursor:pointer;border-radius:5px;padding:.2rem .5rem;display:inline-block}.genre-block:hover{background-color:#d3d3d3}#genre-container{text-align:center;width:100%;margin-bottom:1rem;display:inline-block}.leaflet-container{background:#000;max-width:100%;max-height:100%}#search{height:24px;margin-bottom:.25rem;margin-left:6px;font-size:1rem}#suggestions{background-color:#fff;width:370px;max-height:200px;margin-left:0;padding-top:.75rem;padding-bottom:.75rem;padding-left:1rem;list-style-type:none;list-style-position:inside;overflow-y:auto}#suggestions li{cursor:pointer;white-space:nowrap;text-overflow:ellipsis;max-height:200px;margin-bottom:0;display:block;overflow:hidden auto}#suggestions li:hover{background-color:#d3d3d3}</style><link href=/js/leaflet/1.9.4/leaflet.css rel=stylesheet><script src=/js/leaflet/1.9.4/leaflet.js></script><link href=/js/leaflet-fullscreen/1.0.2/leaflet.fullscreen.css rel=stylesheet><script src=/js/leaflet-fullscreen/1.0.2/Leaflet.fullscreen.min.js></script><script src=uFuzzy.iife.min.js></script><script src=visual-book-recs.js></script></div></div></body></html>