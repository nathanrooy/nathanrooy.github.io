<!doctype html><html lang=en><head><meta charset=utf-8><title>Nathan Rooy</title>
<meta content="Nathan Rooy" name=author><meta content="en" name=language><meta content="width=device-width,minimum-scale=1" name=viewport><meta content="nry.me" property="og:site_name"><meta content="nry.me" property="twitter:domain"><meta content="article" property="og:type"><meta content="https://nry.me/posts/2023-11-19/windspeed-golang-serverless/" property="og:url"><meta content="https://nry.me/posts/2023-11-19/windspeed-golang-serverless/" name=twitter:url><meta content="Nathan A. Rooy" name=copyright><meta content="summary_large_image" name=twitter:card><meta content="windspeed.app,strava,go,golang,serverless,netlify" name=keywords><meta content="Porting windspeed.app to Go" name=twitter:title><meta content="Porting windspeed.app to Go" property="og:title"><meta content="Windspeed.app is now serverless" name=description><meta content="Windspeed.app is now serverless" name=twitter:description><meta content="Windspeed.app is now serverless" property="og:description"><meta content="https://nry.me/posts/2023-11-19/windspeed-golang-serverless/space-shuttle.jpg" name=twitter:image><meta content="https://nry.me/posts/2023-11-19/windspeed-golang-serverless/space-shuttle.jpg" property="og:image"><meta content="https://nry.me/posts/2023-11-19/windspeed-golang-serverless/space-shuttle.jpg" name=thumbnail><link href=https://nry.me/index.xml rel=alternate type=application/rss+xml title="Nathan Rooy"><link href=/favicon/favicon.png rel=icon type=image/png><link href=/fonts/figtree-v1-latin-regular.woff2 rel=preload as=font type=font/woff2 crossorigin><link href=https://nry.me/posts/2023-11-19/windspeed-golang-serverless/ rel=canonical><link rel=blogroll type=text/xml href=https://raw.githubusercontent.com/nathanrooy/feedly-opml-archiver/refs/heads/main/feedly.opml><script defer data-domain=nry.me src=https://plausible.io/js/script.tagged-events.js></script><style>:root{--main-text-color:#222;--main-text-weight:400;--text-bold:600;--font-family:"Figtree", sans-serif;--background-light:#F5F5F5;--link-text-color:#0955b5;--dark-text-color:#999}html{font-size:16px}body{-webkit-font-smoothing:antialiased;font-family:var(--font-family);color:var(--main-text-color);font-weight:var(--main-text-weight)}.wrapper{max-width:660px;margin:6rem auto 0;padding:1rem}@media only screen and (max-width:750px){.wrapper{margin-top:2.5rem;margin-left:0}}a{text-decoration:none;color:var(--link-text-color)}a:hover{text-decoration:underline}a:visited{color:var(--link-text-color)}::selection{background:#fff9c4;text-shadow:none}#map img{margin:0}img{margin:1.5em auto;max-width:100%;display:block}a img{border:none}@font-face{font-family:Figtree;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/figtree-v1-latin-regular.eot);src:local(''),url(/fonts/figtree-v1-latin-regular.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-regular.woff2)format('woff2'),url(/fonts/figtree-v1-latin-regular.woff)format('woff'),url(/fonts/figtree-v1-latin-regular.ttf)format('truetype'),url(/fonts/figtree-v1-latin-regular.svg#Figtree)format('svg')}@font-face{font-family:Figtree;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/figtree-v1-latin-600.eot);src:local(''),url(/fonts/figtree-v1-latin-600.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-600.woff2)format('woff2'),url(/fonts/figtree-v1-latin-600.woff)format('woff'),url(/fonts/figtree-v1-latin-600.ttf)format('truetype'),url(/fonts/figtree-v1-latin-600.svg#Figtree)format('svg')}.wrapper{padding-bottom:8rem}.markdown ol li{padding-bottom:.75em}p{font-size:1rem;margin:0 0 1rem;line-height:1.7rem;letter-spacing:.01rem;word-spacing:.025rem}h1{font-weight:var(--main-text-weight);font-size:2.3rem;color:var(--main-text-color);line-height:2.64rem}h2{font-size:1.2rem;font-weight:var(--text-bold);margin-bottom:.3em}*+h2{padding-top:2rem}table{width:100%;font-size:14px;letter-spacing:-.01em;border-collapse:collapse;margin:2rem auto;line-height:1.2rem}table th{text-align:left}table thead{border-bottom:1px solid var(--main-text-color);line-height:1.4em}ul{padding-left:15px;list-style:disc inside}ul li{margin-bottom:.5rem}ul li p{display:inline}hr{margin:4rem 0;height:1px;border:none;color:var(--main-text-color);background-color:var(--main-text-color)}@media only screen and (min-width:751px){#burger{padding-left:2rem;padding-top:2rem}}@media only screen and (max-width:750px){#burger{padding-left:1rem;padding-top:1rem}}#burger{font-family:var(--font-family);font-weight:400;color:#a9a9a9;font-size:1.5rem}#burger a{display:inline-block;padding-right:.8rem}#burger label{cursor:pointer}#burger label:hover{color:var(--main-text-color)}#nav-icons{padding-left:.8rem}#nav-icons svg{max-height:20px;margin-bottom:-.05rem;color:var(--main-text-color)}#l1-val{position:relative;top:-.12rem}#l2-val{position:relative;top:-.2rem;padding-left:.1rem;padding-right:.1rem}#burger-cbox{display:none}#label-1{display:inline-block}#label-2{display:none}#burger-cbox:not(:checked)~#nav-icons{display:none}#burger-cbox:checked~#nav-icons{display:inline-block}#burger-cbox:checked~#label-1{display:none}#burger-cbox:checked~#label-2{display:inline-block;color:var(--main-text-color)}.TLDR{font-size:1.1rem}figure{margin:0;text-align:center}.figcaption{font-size:.8rem;padding-bottom:1rem}.post .post-header{margin-bottom:2.5rem}.post .post-header .title{margin:0}.post blockquote{background-color:var(--background-light);border-left:10px solid;border-color:#2dad60;padding:1.5rem;margin:0 0 1rem;line-height:1.5rem;font-size:15px}.highlighter-rouge{position:relative;font-size:.75rem;color:var(--main-text-color);border:1px solid;border-color:#e6e6e6;border-radius:3px;background-color:var(--background-light);padding:.1rem .2rem}.math-block{margin-top:2rem;margin-bottom:2rem}mtext{position:absolute;right:0}.inline-svg-equation{text-align:center;margin:1.5em auto;max-width:100%;display:block}.highlight pre{padding:20px;background-color:transparent!important;overflow:auto;word-wrap:normal;white-space:pre}.highlight{background:0 0;background-color:var(--background-light);margin:1.5rem auto;font-size:.85rem}</style></head><body><div class=header><nav><div id=burger><input type=checkbox id=burger-cbox>
<label id=label-1 for=burger-cbox><span>[</span><span id=l1-val>+</span><span>]</span>
</label><label id=label-2 for=burger-cbox><span>[</span><span id=l2-val>x</span><span>]</span></label><div id=nav-icons><a class="plausible-event-name=burger+home" aria-label=Home style=padding-right:.7rem href=/><svg id="home-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></a>
<a class="plausible-event-name=burger+reading" aria-label=Reading href=/reading><svg width="24" height="24" viewBox="0 0 23.809855 18.892912" id="svg5"><defs id="defs2"/><g id="layer1" transform="translate(-6.352941,-30.26865)"><g id="g39" transform="matrix(0.26458333,0,0,0.26458333,5.0300244,26.48677)"><path class="st0" d="m92.22 22.9v59C74.24 76.35 61.26 78.85 54.73 81.04 59.2 76.64 68.54 70.55 84.16 74.14l1.69.39V21.42c2.17.29 4.3.77 6.37 1.48z" id="path11"/><path class="st0" d="M45.24 81.04C38.73 78.85 25.74 76.35 7.77 81.9v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.96 2.5 29.42 6.9z" id="path13"/><polygon points="48.86,85.63 48.82,85.58 48.91,85.63" id="polygon15"/><polygon points="51.17,85.58 51.13,85.63 50,85.63 51.09,85.62" id="polygon17"/><path d="m94.09 20.63c-2.68-1-5.45-1.65-8.24-2.02v-2.94l-1.08-.24c-17.8-4.09-28.32 3.81-32.9 8.68-.81.87-1.44 1.63-1.88 2.22C49.54 25.74 48.91 24.98 48.1 24.11c-4.58-4.87-15.11-12.76-32.9-8.68l-1.07.24v2.94c-2.8.38-5.57 1.02-8.24 2.02L5 20.97V85.7l1.81-.61c13.49-4.49 24.13-4.16 30.68-3.08 7.09 1.15 11.05 3.4 11.09 3.42l.23.14.09.06H50l1.09-.01.08-.05.23-.14c.05-.02 4-2.27 11.09-3.42 6.55-1.08 17.19-1.41 30.68 3.08l1.82.61V20.97zM7.78 81.89v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.95 2.5 29.42 6.9-6.52-2.18-19.5-4.68-37.47.86zm40.76-1.3c-4.19-4.66-14.29-12.83-31.63-9.5v-53.2c11.11-2.28 18.93.38 24.02 3.66 2.6 1.68 4.48 3.52 5.71 4.95 1.14 1.32 1.73 2.28 1.82 2.43l.08.15zm2.76.17V29.34l.24-.4c.09-.16.68-1.12 1.82-2.44 1.23-1.43 3.11-3.27 5.71-4.94 5.08-3.29 12.91-5.95 24.02-3.67v53.2C65.54 67.72 55.4 76.13 51.3 80.76zm40.92 1.13C74.24 76.34 61.26 78.84 54.73 81.03 59.2 76.63 68.54 70.54 84.16 74.13l1.69.39v-53.1c2.16.29 4.3.77 6.37 1.48z" id="path19"/></g></g><style id="style9">.st0{fill:none}</style></svg>
</a><a class="plausible-event-name=burger+nycbike" aria-label="NYC Bike Exploring" style=margin-left:.4rem href=/bike-exploring/nyc><svg viewBox="0 0 91.5 52.5" width="32" height="24"><g transform="matrix(-1,0,0,1,95.8,-23.9)"><path d="m78 40.6c-3.8.0-7.3 1.2-10.2 3.2l-7.4-9.4 2.9-8.5H67c.6.0 1-.4 1-1s-.4-1-1-1H54.8c-.6.0-1 .4-1 1s.4 1 1 1h6.3l-2.3 6.7c-.2-.2-.4-.3-.7-.3H32l2.2-6.4h5.7c.6.0 1-.4 1-1s-.4-1-1-1h-6.4c-.4.0-.8.3-.9.7l-5.7 16.8c-1.5-.4-3.1-.7-4.8-.7-9.8.0-17.8 8-17.8 17.8s8 17.8 17.8 17.8 17.8-8 17.8-17.8c0-7.5-4.6-13.9-11.2-16.5l2.6-7.6 19 24.4c.1.3.3.6.6.7.1.0.2.1.3.1h.1 8.9c.5 9.4 8.3 16.8 17.8 16.8 9.8.0 17.8-8 17.8-17.8s-8-18-17.8-18zM37.8 58.4c0 8.7-7.1 15.8-15.8 15.8S6.2 67.1 6.2 58.4 13.3 42.6 22 42.6c1.4.0 2.8.2 4.1.6L21 58.1c-.2.5.1 1.1.6 1.3.1.0.2.1.3.1.4.0.8-.3.9-.7l5.1-14.9c5.9 2.2 9.9 7.9 9.9 14.5zm29.7-11.8L76 57.4H62.2c.3-4.3 2.2-8.1 5.3-10.8zm-16.7 9.6-17.1-22h24l.4.5zm1.8 1.2 7.1-20.8 6.6 8.4c-3.5 3.1-5.7 7.4-6 12.4zM78 74.2c-8.4.0-15.2-6.6-15.8-14.8H78c.4.0.7-.2.9-.6.2-.3.1-.8-.1-1.1L69 45.4c2.5-1.8 5.6-2.8 8.9-2.8 8.7.0 15.8 7.1 15.8 15.8s-7 15.8-15.7 15.8z"/></g></svg></a>
<a class="plausible-event-name=burger+about" aria-label=About href=/about><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" id="about-icon"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
</a><a class="plausible-event-name=burger+rss" aria-label=RSS href=/index.xml><svg width="24" height="24" viewBox="0 0 30 24" fill="none" stroke="#444" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss" id="rss-icon"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></div></nav></div><div class="wrapper post"><div class=post-header><h1 class=title>Porting windspeed.app to Go</h1></div><hr><div class=markdown><p>I&rsquo;ve been running <a href=https://windspeed.app/>a small web service</a> that adds weather details to Strava activities for the past year or so. It&rsquo;s a super simple Python/Flask app that I actually just forked from <a href=https://github.com/vol1ura>Yuriy Volodin</a>, made <a href=https://github.com/vol1ura/strava_weather_app/compare/master...nathanrooy:strava-weather-service:master>a couple changes</a>, and deployed it with <a href=https://railway.app/>Railway.app</a>. It&rsquo;s been working without incident ever since.</p><p style=background-color:var(--background-light);padding-top:2rem;padding-bottom:2rem;margin-top:2rem;margin-bottom:2rem><img style=max-height:650px;max-width:80%;margin-top:0;margin-bottom:0 src=example-weather-stamp.png alt="example weather stamp from windspeed.app"></p><p>The Railway.app experience has been great and I really like the platform, but it’s the wrong tool for the job. Even though there are about 200 active subscribers using the service, having a dedicated server that&rsquo;s running continuously is a bit much.</p><p>I decided to refactor it into a serverless architeture that now runs on <a href=https://www.netlify.com/>Netlify</a> and connects to a <a href=https://www.cockroachlabs.com/>CockroachDB</a> sql database. Since Netlify doesn&rsquo;t support Python based serverless functions I also decided to teach myself <a href=https://go.dev/>Go</a>. I&rsquo;ve been using Python basically every day for over a decade now and it recently dawned on me that I&rsquo;m really tired of it. Overall I was really impressed with Netlify. Actually, the whole Netlify/Go/serverless experience has been really enjoyable. I&rsquo;m clearly not a web developer, but I practically fell into a working solution within the span of a weekend.</p><img src=windspeed-logo.svg style=width:60%;max-width:500px alt="windspeed.app logo"><p>Throughout this migration, I ended up reading two books: <a href=https://search.worldcat.org/title/1240567002>Learning Go: An Idiomatic Approach</a> and <a href=https://search.worldcat.org/title/1152989914>Cloud Native Go</a>. I only got about half way through the latter since many of the patterns are overkill for this, but they were both pretty good. So far, Go has been a great distraction. It maintains the readability of Python while keeping all the things I like about C.</p><h2 id=golang-fortran-of-web>Will Go become the Fortran of cloud services?</h2><p>I certainly hope so! But I obviously can&rsquo;t speak for the Golang community or maintainers, but from my very limited view, it appears that it could be and that makes me very excited. Why? I like Fortan a lot. I also know that a lot of people who aren&rsquo;t familiar with Fortran often lump it in with obsolete languages like <a href=https://en.wikipedia.org/wiki/COBOL>COBOL</a>. I get why people do that, but it&rsquo;s not correct. Yes, Fortran is old but its latest stable release was in 2018 and the <a href=https://github.com/fortran-lang/stdlib/commits/master>standard library continues to get regular updates</a>. Also, have you seen the new <a href=https://github.com/fortran-lang/fpm>Fortran package manager</a>? It&rsquo;s really good! And now, thanks to <a href=https://llvm.org/>LLVM</a> you can compile to WebAssembly and run <a href=https://dev.lfortran.org/>directly in the browser</a>!</p><p>So how does this relate to Go? Well, reading through various docs and libraries I would come across statements such as:</p><blockquote style=border-left:none;padding:2rem><p>It is intended that programs written to the Go 1 specification will continue to compile and run correctly, unchanged, over the lifetime of that specification. At some indefinite point, a Go 2 specification may arise, but until that time, Go programs that work today should continue to work even as future "point" releases of Go 1 arise (Go 1.1, Go 1.2, etc.).</p><br><p style=text-align:right;padding-bottom:0;padding-top:1rem>- Go 1 and the Future of Go Programs (<a href=https://go.dev/doc/go1compat>source</a>)</p></blockquote><p>Or this (<a href=https://github.com/gorilla/csrf>gorilla/csrf</a>):</p><img style="border:1px solid #000;width:658px" src=gorilla-csrf.jpg alt="Gorilla CSRF statement"><p>To me, these statements suggest a much longer planning horizon than what I tend to see in the Python ecosystem, and that&rsquo;s refreshing. My background is aerospace engineering, but I worked in motorsport and across these two domains, I&rsquo;ve seen <em>a lot</em> of Fortran. Some of these code bases are older than I am, compile without error and run just fine. Probably the most obvious example is <a href=https://github.com/nasa/NASTRAN-95>NASTRAN</a>. Originally developed almost 50 years ago, it has since touched just about every aspect of modern life. If you&rsquo;ve flown in basically any contemporary Boeing aircraft you can thank NASTRAN. At least a few of the rockets which carried the satellites you depend on for data connectivity were designed using NASTRAN. It helped design the Space Shuttle and I&rsquo;ve seen it used extensively in F1/<a href=https://en.wikipedia.org/wiki/FIA_World_Endurance_Championship>WEC</a>. The fingerprints of NASTRAN are everywhere. Actually, now that I’m thinking about it, since NASTRAN was built using <em>our</em> tax dollars, it may actually represent one of the best investments we’ve ever made as a country…</p><img src=space-shuttle.jpg alt="Space shuttle launch"><p>And it’s not just NASTRAN, <a href=https://web.mit.edu/drela/Public/web/xfoil/>XFOIL</a> and many other simulation codes have enough experimentally verified results they could fill a small library. I’d also be willing to bet that <a href=https://en.wikipedia.org/wiki/Lockheed_Have_Blue>ECHO 1</a> was also written in Fortran. If you live in the US and checked the weather this morning, odds are those values came from the NOAA <a href=https://github.com/NOAA-EMC>UFS weather model</a> which… you get the idea. Fortran may be &ldquo;old&rdquo;, but it’s everywhere. Fortran represents code that will compile decades after the last update with minimal fuss.</p><p>I’ve gotten a bit carried away, but this is basically a very long winded way of saying that I’m really tired of code rot and dependency management. I’m tired of building things that don’t work a year later. I’ve got a dozen TensorFlow models currently serving production traffic at work and just dealing with those gets annoying. I can’t imagine how much functionality they’ll lose after a few years of neglect, let alone one or more decades. Yes, simulation code is completely different than stuff written for the internet but those statements and others like it capture some of the qualities that I think makes Fortran useful and relevant today. If Fortran is the backbone of scientific computing, Go may very well become the backbone of web services.</p><h2 id=chatgpt--bard>ChatGPT / Bard</h2><p>Throughout the process of teaching myself Go and building out this project, I&rsquo;ve been playing around with ChatGPT and Google&rsquo;s lesser known alternative; Bard. Nothing I&rsquo;m doing is terribly complex, but getting a second (or third) opinion has been fun. I&rsquo;ll occasionally get the hallucinated nonexistent method, but overall the experience has been both positive and surprising. I know that we&rsquo;re currently in the MNIST stages of LLMs but given their overall simplicity, the end result is nothing short of remarkable. For instance, to create a top tier LLM, you need the following:</p><ul><li>Basic statistics</li><li>High school level calculus (which most ML &ldquo;engineers&rdquo; still don&rsquo;t know)</li><li>Colossal amounts of data and compute</li></ul><p>That&rsquo;s it. LLMs are simpler than the hardware they run on! If LLMs are to NLP what CNNs where to traditional CV (<a href=https://en.wikipedia.org/wiki/Histogram_of_oriented_gradients>HOGs</a>, <a href=https://en.wikipedia.org/wiki/Edge_detection>edge detection</a>, etc&mldr;) we might be in for an exciting ride!</p></div></div></body></html>