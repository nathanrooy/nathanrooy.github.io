<!doctype html><html lang=en><head><meta charset=utf-8><title>Nathan Rooy</title>
<meta content="Nathan Rooy" name=author><meta content="en" name=language><meta content="width=device-width,minimum-scale=1" name=viewport><meta content="nathan.fun" property="og:site_name"><meta content="nathan.fun" property="twitter:domain"><meta content="article" property="og:type"><meta content="https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/" property="og:url"><meta content="https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/" name=twitter:url><meta content="Nathan A. Rooy" name=copyright><meta content="summary_large_image" name=twitter:card><meta content="pso,particle swarm optimization,python,tutorial,evolutionary optimization,optimization" name=keywords><meta content="Particle Swarm Optimization from Scratch with Python" name=twitter:title><meta content="Particle Swarm Optimization from Scratch with Python" property="og:title"><meta content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python" name=description><meta content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python" name=twitter:description><meta content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python" property="og:description"><meta content="https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/pso-vector-1.png" name=twitter:image><meta content="https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/pso-vector-1.png" property="og:image"><meta content="https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/pso-vector-1.png" name=thumbnail><link href=https://nathan.fun/index.xml rel=alternate type=application/rss+xml title="Nathan Rooy"><link href=/favicon/favicon.png rel=icon type=image/png><link href=/fonts/figtree-v1-latin-regular.woff2 rel=preload as=font type=font/woff2 crossorigin><link href=https://nathan.fun/posts/2016-08-17/simple-particle-swarm-optimization-with-python/ rel=canonical><script defer data-domain=nathanrooy.github.io src=https://plausible.io/js/script.tagged-events.js></script><style>/*!normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--main-text-color:#222;--main-text-weight:400;--text-bold:600;--font-family:"Figtree", sans-serif;--background-light:#F5F5F5}body{-webkit-font-smoothing:antialiased}@font-face{font-family:figtree;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/figtree-v1-latin-regular.eot);src:local(''),url(/fonts/figtree-v1-latin-regular.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-regular.woff2)format('woff2'),url(/fonts/figtree-v1-latin-regular.woff)format('woff'),url(/fonts/figtree-v1-latin-regular.ttf)format('truetype'),url(/fonts/figtree-v1-latin-regular.svg#Figtree)format('svg')}@font-face{font-family:figtree;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/figtree-v1-latin-600.eot);src:local(''),url(/fonts/figtree-v1-latin-600.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-600.woff2)format('woff2'),url(/fonts/figtree-v1-latin-600.woff)format('woff'),url(/fonts/figtree-v1-latin-600.ttf)format('truetype'),url(/fonts/figtree-v1-latin-600.svg#Figtree)format('svg')}.home-page{font-family:var(--font-family);color:var(--main-text-color);margin-top:0;padding-bottom:6rem}.home-page ul li{margin-bottom:.3rem}.home-page ul a{color:var(--main-text-color)}.post-li-title{width:95%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;float:left}.post-li-date{float:left;padding-bottom:1em;font-size:16px;color:#a9a9a9}@media only screen and (min-width:501px){.wrapper{max-width:660px;margin:0 auto;padding:1rem}.container{margin-top:6rem}.post-li-title{font-size:19px}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.6em;margin-top:0}.post-li{overflow:hidden}}@media only screen and (max-width:950px){.container{margin-top:0}}@media only screen and (max-width:500px){.wrapper{margin:0 auto}.container{margin:2rem 1rem 1rem}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.5em;margin-top:.2rem}.post-li{overflow:hidden}}.nyc-progress-image{margin-top:-1rem}.strava-grid{padding-top:1rem}.highlight{margin-bottom:1rem;font-size:14px;line-height:1.2rem}.markdown .footnotes hr{margin-top:4rem;margin-bottom:4rem;height:1px;border:none;color:var(--main-text-color);background-color:var(--main-text-color)}.markdown .footnotes ol{counter-reset:item;padding-left:0;padding-right:0;width:fit-content;color:#757575}.markdown .footnotes li{display:block;padding-bottom:0}.markdown .footnotes li:before{content:counter(item)". ";counter-increment:item;width:2em;display:inline-block;position:absolute}.markdown .footnotes li p{padding-left:2rem;line-height:1.25rem}.markdown .footnotes li a{color:#757575}.markdown .footnotes li a:hover{color:var(--main-text-color)}.inline-svg-equation{text-align:center;margin:1.5em auto;max-width:100%;display:block}ul.flat{margin:0;padding:0}ul.flat li{display:inline-block;list-style:none;margin-left:0}.markdown .post-update{background-color:var(--background-light);border-left:10px solid;border-color:#e74c3c;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:1rem;margin-left:0;margin-right:0;margin-bottom:2rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.highlighter-rouge{position:relative;font-size:.75rem;color:var(--main-text-color);border:1px solid;border-color:#e6e6e6;border-radius:3px;background-color:#f2f2f2;padding:.1rem .2rem}.figcaption{font-size:.8rem;padding-bottom:1rem}.markdown .photoset-grid-lightbox{margin-bottom:1rem}.markdown{font-family:var(--font-family);color:var(--main-text-color);padding-bottom:8rem}.markdown ol{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;padding-bottom:0;line-height:1.2rem;padding-right:2em;width:85%;margin-block-end:.25em}.markdown ol li{padding-bottom:.75em}.markdown p{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;margin-bottom:1rem;line-height:1.7rem;letter-spacing:.01rem;word-spacing:.025rem}.markdown blockquote{background-color:#f2f2f2;border-left:10px solid;border-color:#2dad60;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:0;margin-left:0;margin-right:0;margin-bottom:1rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.markdown blockquote p{margin-bottom:0}.markdown h2{font-family:figtree;font-size:1.2rem;font-weight:var(--text-bold);margin-bottom:.3em}*+h2{padding-top:2rem}.markdown .ul-style-b li{margin-bottom:.5rem;font-size:16px}.TLDR{font-family:var(--font-family);padding-top:0;margin-top:0;margin-bottom:0;font-size:1.1rem;line-height:1.7rem;font-weight:var(--main-text-weight);letter-spacing:.02rem}table{width:100%;font-size:14px;letter-spacing:-.01em;border-collapse:collapse;margin-bottom:2em;margin-top:2em;font-weight:var(--main-text-weight);line-height:1.2rem}table th{text-align:left}table thead{border-bottom:1px solid var(--main-text-color);line-height:1.4em}.post-header h1{font-weight:var(--main-text-weight);font-size:2.3rem;font-family:var(--font-family);color:var(--main-text-color);line-height:2.64rem}.post ul li{margin-bottom:10px}.post ul li p{display:inline}.post .post-header{margin-bottom:2.5rem}.post .post-header .title{margin:0}.post .post-header .meta{padding-left:0;margin-top:10px}.post .post-header a{color:#999}.post .post-header a:hover{text-decoration:underline}.post .post-header a:visited{color:#999}.post hr{margin-top:4rem;margin-bottom:4rem;height:1px;border:none;color:var(--main-text-color);background-color:var(--main-text-color)}a{text-decoration:none;color:#0955b5}a:hover{text-decoration:underline}a:visited{color:#205caa}::selection{background:#fff9c4;text-shadow:none}#map img{margin:0;max-width:100%;display:block}img{margin:1.5em auto;max-width:100%;display:block}a img{border:none}figure{margin:0;text-align:center}ul{padding-left:15px}ul{list-style:disc inside}.markdown ul li{font-size:15px}.highlight pre{margin-bottom:0;margin-top:0;padding:20px;background-color:transparent!important;overflow:auto;word-wrap:normal;white-space:pre}.highlight{background:0 0;background-color:#fafafa}.meta{font-family:var(--font-family);font-size:.8rem;color:#999;margin-bottom:4px}.list .posts .post .meta{margin-bottom:0;margin-left:5px}.markdown .photoset-grid-lightbox{margin-bottom:1rem}table .katex-display{margin-top:.2rem;margin-bottom:.2rem}.post ul li .katex-display{display:inline-block;list-style:none;margin-left:0;margin-bottom:0;line-height:0;padding:0}@media only screen and (min-width:501px){#burger{padding-left:2rem;padding-top:2rem}}@media only screen and (max-width:950px){#burger{padding-left:1rem;padding-top:1rem;padding-bottom:1.5rem}}@media only screen and (max-width:500px){#burger{padding-left:1rem;padding-top:1rem}}#burger{font-family:var(--font-family);font-weight:400;color:#a9a9a9;font-size:1.5rem}#burger a{display:inline-block;padding-right:.8rem}#burger label{cursor:pointer}#burger label:hover{color:var(--main-text-color)}#nav-icons{padding-left:.8rem}#nav-icons svg{max-height:20px;margin-bottom:-.05rem;color:var(--main-text-color)}#l1-val{position:relative;top:-.12rem}#l2-val{position:relative;top:-.2rem;padding-left:.1rem;padding-right:.1rem}#burger-cbox{display:none}#label-1{display:inline-block}#label-2{display:none}#burger-cbox:not(:checked)~#nav-icons{display:none}#burger-cbox:checked~#nav-icons{display:inline-block}#burger-cbox:checked~#label-1{display:none}#burger-cbox:checked~#label-2{display:inline-block;color:var(--main-text-color)}</style></head><body><div class=header><nav role=navigation><div id=burger><input type=checkbox id=burger-cbox autocomplete=off>
<label id=label-1 for=burger-cbox><span>[</span><span id=l1-val>+</span><span>]</span>
</label><label id=label-2 for=burger-cbox><span>[</span><span id=l2-val>x</span><span>]</span></label><div id=nav-icons><a class="plausible-event-name=burger+home" aria-label=Home style=padding-right:.7rem href=/><svg id="home-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></a>
<a class="plausible-event-name=burger+reading" aria-label=Reading href=/reading><svg width="24" height="24" viewBox="0 0 23.809855 18.892912" id="svg5" inkscape:version="1.1 (c4e8f9e, 2021-05-24)" sodipodi:docname="book.svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" inkscape:pageshadow="2" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:document-units="mm" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom=".69130191" inkscape:cx="77.39021" inkscape:cy="446.98271" inkscape:window-width="1920" inkscape:window-height="1011" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="g39"/><defs id="defs2"/><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-6.352941,-30.26865)"><g id="g39" transform="matrix(0.26458333,0,0,0.26458333,5.0300244,26.48677)"><path class="st0" d="m92.22 22.9v59C74.24 76.35 61.26 78.85 54.73 81.04 59.2 76.64 68.54 70.55 84.16 74.14l1.69.39V21.42c2.17.29 4.3.77 6.37 1.48z" id="path11"/><path class="st0" d="M45.24 81.04C38.73 78.85 25.74 76.35 7.77 81.9v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.96 2.5 29.42 6.9z" id="path13"/><polygon points="48.86,85.63 48.82,85.58 48.91,85.63" id="polygon15"/><polygon points="51.17,85.58 51.13,85.63 50,85.63 51.09,85.62" id="polygon17"/><path d="m94.09 20.63c-2.68-1-5.45-1.65-8.24-2.02v-2.94l-1.08-.24c-17.8-4.09-28.32 3.81-32.9 8.68-.81.87-1.44 1.63-1.88 2.22C49.54 25.74 48.91 24.98 48.1 24.11c-4.58-4.87-15.11-12.76-32.9-8.68l-1.07.24v2.94c-2.8.38-5.57 1.02-8.24 2.02L5 20.97V85.7l1.81-.61c13.49-4.49 24.13-4.16 30.68-3.08 7.09 1.15 11.05 3.4 11.09 3.42l.23.14.09.06H50l1.09-.01.08-.05.23-.14c.05-.02 4-2.27 11.09-3.42 6.55-1.08 17.19-1.41 30.68 3.08l1.82.61V20.97zM7.78 81.89v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.95 2.5 29.42 6.9-6.52-2.18-19.5-4.68-37.47.86zm40.76-1.3c-4.19-4.66-14.29-12.83-31.63-9.5v-53.2c11.11-2.28 18.93.38 24.02 3.66 2.6 1.68 4.48 3.52 5.71 4.95 1.14 1.32 1.73 2.28 1.82 2.43l.08.15zm2.76.17V29.34l.24-.4c.09-.16.68-1.12 1.82-2.44 1.23-1.43 3.11-3.27 5.71-4.94 5.08-3.29 12.91-5.95 24.02-3.67v53.2C65.54 67.72 55.4 76.13 51.3 80.76zm40.92 1.13C74.24 76.34 61.26 78.84 54.73 81.03 59.2 76.63 68.54 70.54 84.16 74.13l1.69.39v-53.1c2.16.29 4.3.77 6.37 1.48z" id="path19"/></g></g><style id="style9">.st0{fill:none}</style></svg>
</a><a class="plausible-event-name=burger+nycbike" aria-label="NYC Bike Exploring" style=margin-left:.4rem href=/bike-exploring/nyc><svg viewBox="0 0 91.5 52.5" width="32" height="24" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><g transform="matrix(-1,0,0,1,95.8,-23.9)"><path d="m78 40.6c-3.8.0-7.3 1.2-10.2 3.2l-7.4-9.4 2.9-8.5H67c.6.0 1-.4 1-1s-.4-1-1-1H54.8c-.6.0-1 .4-1 1s.4 1 1 1h6.3l-2.3 6.7c-.2-.2-.4-.3-.7-.3H32l2.2-6.4h5.7c.6.0 1-.4 1-1s-.4-1-1-1h-6.4c-.4.0-.8.3-.9.7l-5.7 16.8c-1.5-.4-3.1-.7-4.8-.7-9.8.0-17.8 8-17.8 17.8s8 17.8 17.8 17.8 17.8-8 17.8-17.8c0-7.5-4.6-13.9-11.2-16.5l2.6-7.6 19 24.4c.1.3.3.6.6.7.1.0.2.1.3.1h.1 8.9c.5 9.4 8.3 16.8 17.8 16.8 9.8.0 17.8-8 17.8-17.8s-8-18-17.8-18zM37.8 58.4c0 8.7-7.1 15.8-15.8 15.8S6.2 67.1 6.2 58.4 13.3 42.6 22 42.6c1.4.0 2.8.2 4.1.6L21 58.1c-.2.5.1 1.1.6 1.3.1.0.2.1.3.1.4.0.8-.3.9-.7l5.1-14.9c5.9 2.2 9.9 7.9 9.9 14.5zm29.7-11.8L76 57.4H62.2c.3-4.3 2.2-8.1 5.3-10.8zm-16.7 9.6-17.1-22h24l.4.5zm1.8 1.2 7.1-20.8 6.6 8.4c-3.5 3.1-5.7 7.4-6 12.4zM78 74.2c-8.4.0-15.2-6.6-15.8-14.8H78c.4.0.7-.2.9-.6.2-.3.1-.8-.1-1.1L69 45.4c2.5-1.8 5.6-2.8 8.9-2.8 8.7.0 15.8 7.1 15.8 15.8s-7 15.8-15.7 15.8z"/></g></svg>
</a><a class="plausible-event-name=burger+about" aria-label=About href=/about><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" id="about-icon"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
</a><a class="plausible-event-name=burger+rss" aria-label=RSS href=/index.xml><svg width="24" height="24" viewBox="0 0 30 24" fill="none" stroke="#444" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss" id="rss-icon"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></div></nav></div><div class="container wrapper post"><div class=post-header><h1 class=title>Particle Swarm Optimization from Scratch with Python</h1></div><hr><div class=markdown><p>Particle swarm optimization (<a target=_blank href=https://en.wikipedia.org/wiki/Particle_swarm_optimization>PSO</a>) is one of those rare tools that&rsquo;s comically simple to code and implement while producing bizarrely good results. Developed in 1995 by Eberhart and Kennedy, PSO is a biologically inspired optimization routine designed to mimic birds flocking or fish schooling. I&rsquo;ll occasionally use PSO for <a target=_blank href=https://en.wikipedia.org/wiki/Computational_fluid_dynamics>CFD</a> based aerodynamic shape optimization, but more often than not, it&rsquo;s for a machine learning project. PSO is not guaranteed to find the global minimum, but it does a solid job in challenging, high dimensional, non-convex, non-continuous environments. In this short introductory tutorial, I&rsquo;ll demonstrate PSO in its absolute simplest form. At a later date, I&rsquo;ll create another PSO tutorial featuring a more advanced implementation.</p><p>Below, are the only two equations that make up a bare bones PSO algorithm. As a heads up, &ldquo;k&rdquo; references the current iteration, therefore &ldquo;k+1&rdquo; implies the next iteration.</p><p>Particle position:</p><p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><mo>+</mo><msubsup><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">x_{k+1}^i = x_{k}^i + v_{k+1}^i</annotation></semantics></math></p><p>Particle velocity:</p><p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>v</mi><mi>k</mi><mi>i</mi></msubsup><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>r</mi><mn>1</mn></msub><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>k</mi><mi>i</mi></msubsup><mo>−</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>r</mi><mn>2</mn></msub><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>k</mi><mi>g</mi></msubsup><mo>−</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_{k+1}^i = w_k v_k^i + c_1 r_1 \left(p_k^i - x_k^i\right) + c_2 r_2 \left(p_k^g - x_k^i\right)</annotation></semantics></math></p><p>Where:</p><style>table td{padding-bottom:.25rem;padding-top:.25rem;line-height:1.2rem}</style><div style=margin-left:2rem;font-size:16px;padding-bottom:1rem><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">x_k^i</annotation></semantics></math></div><div>particle position</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>v</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">v_k^i</annotation></semantics></math></div><div>particle velocity</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">p_k^i</annotation></semantics></math></div><div>best individual particle position</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mi>k</mi><mi>g</mi></msubsup><annotation encoding="application/x-tex">p_k^g</annotation></semantics></math></div><div>best swarm (global) position</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>k</mi></msub><annotation encoding="application/x-tex">w_k</annotation></semantics></math></div><div>constant inertia weight</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mspace width="5px"/><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">c_1, c_2</annotation></semantics></math></div><div>cognitive and social parameters respectively</div></div><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:10%><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo separator="true">,</mo><mspace width="5px"/><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_1, r_2</annotation></semantics></math></div><div>random numbers between 0 and 1</div></div></div><p>From the particle velocity equation, two important groups emerge:</p><div style=margin-left:2rem;font-size:16px;padding-bottom:1rem><div style=display:flex;align-items:center;padding-bottom:1rem><div style=flex:1;max-width:30%>1. social term:</div><div style=flex:1><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><msub><mi>r</mi><mn>2</mn></msub><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>k</mi><mi>g</mi></msubsup><mo>−</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_2 r_2 \left(p_k^g - x_k^i\right)</annotation></semantics></math></div></div><div style=display:flex;align-items:center><div style=flex:1;max-width:30%>2. cognitive term:</div><div style=flex:1><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><msub><mi>r</mi><mn>1</mn></msub><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>p</mi><mi>k</mi><mi>i</mi></msubsup><mo>−</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_1 r_1 \left(p_k^i - x_k^i\right)</annotation></semantics></math></div></div></div><p>Using these two simple equations, the basic flow structure of a PSO routine is as follows:</p><div style=background-color:var(--background-light);padding-top:1.5rem;padding-bottom:.5rem;padding-left:2rem;padding-right:2rem;margin-top:1rem;margin-bottom:1rem;border-radius:10px><p>A) Initialize</p><ol class=ul-style-b><li>Set constants:<math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo separator="true">,</mo><mspace width="5px"/><msub><mi>w</mi><mi>k</mi></msub><mo separator="true">,</mo><mspace width="5px"/><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mspace width="5px"/><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_{max}, w_k, c_1, c_2</annotation></semantics></math></li><li>Randomly initialize particle positions.</li><li>Randomly initialize particle velocities.</li><li>Set k=1 (iteration counter).</li></ol><p>B) Optimize</p><ol class=ul-style-b><li>Evaluate cost function <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>f</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">f_k^i</annotation></semantics></math> at each particle position<math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">x_k^i</annotation></semantics></math></li><li>If <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>f</mi><mi>k</mi><mi>i</mi></msubsup><mo>≤</mo><msubsup><mi>f</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">f_k^i \le f_{best}^i</annotation></semantics></math> then <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>f</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>f</mi><mi>k</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">f_{best}^i = f_k^i</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>k</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">p_k^i = x_k^i</annotation></semantics></math>.</li><li>If <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>f</mi><mi>k</mi><mi>i</mi></msubsup><mo>≤</mo><msubsup><mi>f</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>g</mi></msubsup></mrow><annotation encoding="application/x-tex">f_k^i \le f_{best}^g</annotation></semantics></math> then <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>f</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>g</mi></msubsup><mo>=</mo><msubsup><mi>f</mi><mi>k</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">f_{best}^g = f_k^i</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>k</mi><mi>g</mi></msubsup><mo>=</mo><msubsup><mi>x</mi><mi>k</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">p_k^g = x_k^i</annotation></semantics></math>.</li><li>If stopping condition is satisfied, go to C.</li><li>Update all particle velocities.</li><li>Update all particle positions.</li><li>Increment k.</li><li>Go to B(1).</li></ol><p>C) Terminate</p></div><p>That&rsquo;s it! It&rsquo;s really that simple. The main concept behind PSO, which is evident from the particle velocity equation above, is that there is a constant balance between three distinct forces pulling on each particle:</p><ol class=ul-style-b><li>The particles previous velocity (inertia)</li><li>Distance from the individual particles' best known position (cognitive force)</li><li>Distance from the swarms best known position (social force)</li></ol><p>These three forces are then weighted by <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>k</mi></msub><annotation encoding="application/x-tex">w_k</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>1</mn></msub><annotation encoding="application/x-tex">c_1</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>2</mn></msub><annotation encoding="application/x-tex">c_2</annotation></semantics></math> and randomly perturbed by <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mn>1</mn></msub><annotation encoding="application/x-tex">r_1</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mn>2</mn></msub><annotation encoding="application/x-tex">r_2</annotation></semantics></math>. Thus depending on the weighting, either the swarms best location <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mi>k</mi><mi>g</mi></msubsup><annotation encoding="application/x-tex">p_k^g</annotation></semantics></math> or the particles own best position <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mi>k</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">p_k^i</annotation></semantics></math> will pull harder on the particle and dictate the overall direction. That&rsquo;s assuming the particles initial velocity (or inertia) won&rsquo;t cause the particle to wonder around. Often times, if you notice that the convergence is taking longer it&rsquo;s because the particle inertia is weighted to heavily and should be reduced to speed up convergence. Keep in mind, that particle inertia is a double-edged-sword. If you&rsquo;re dealing with a noisy, highly multimodal cost function, too little inertia could result in the particles getting trapped at a local minimum, unable to climb out.</p><p>In vector form, these three forces can be seen below (vector magnitude represents the weight value of that specific force):</p><img alt=pso-vector-1 title=pso-vector-1 src=pso-vector-1.png><center class=figcaption>Figure 1: a high energy particle that will keep exploring the search space</center><p>We can see in the above example that the weighting of the particles inertia and individual best overpower the swarms influence. In this scenario, the particle will continue exploring the search space rather than converge on the swarm. As another example below:</p><img alt=pso-vector-2 title=pso-vector-2 src=pso-vector-2.png><center class=figcaption>Figure 2: a lazy particle that follows the herd</center><p>This time, the weighting assigned to the swarms influence overpowers the individual forces of the particle forcing it towards the swarm. This will result in a faster convergence, at the expense of not fully exploring the search space and potentially finding a better solution.</p><p>The implementation of a simple PSO routine in python is fairly straightforward. We are going to utilize some object-oriented programming and create a swarm of particles using a particle class. These particles will be monitored by a main optimization class. Below is the entire code:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   Nathan A. Rooy</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   Simple Particle Swarm Optimization (PSO) with Python</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   July, 2016</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#--- IMPORT DEPENDENCIES ------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>from</span> <span style=color:#0cf;font-weight:700>__future__</span> <span style=color:#069;font-weight:700>import</span> division
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>random</span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>math</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#--- COST FUNCTION ------------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic># function we are attempting to optimize (minimize)</span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>func1</span>(x):
</span></span><span style=display:flex><span>    total<span style=color:#555>=</span><span style=color:#f60>0</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#366>len</span>(x)):
</span></span><span style=display:flex><span>        total<span style=color:#555>+=</span>x[i]<span style=color:#555>**</span><span style=color:#f60>2</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>return</span> total
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#--- MAIN ---------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>Particle</span>:
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> __init__(self,x0):
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>position_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># particle position</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>velocity_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># particle velocity</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>pos_best_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># best position individual</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>err_best_i<span style=color:#555>=-</span><span style=color:#f60>1</span>          <span style=color:#09f;font-style:italic># best error individual</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>err_i<span style=color:#555>=-</span><span style=color:#f60>1</span>               <span style=color:#09f;font-style:italic># error individual</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>velocity_i<span style=color:#555>.</span>append(random<span style=color:#555>.</span>uniform(<span style=color:#555>-</span><span style=color:#f60>1</span>,<span style=color:#f60>1</span>))
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>position_i<span style=color:#555>.</span>append(x0[i])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic># evaluate current fitness</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>evaluate</span>(self,costFunc):
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>err_i<span style=color:#555>=</span>costFunc(self<span style=color:#555>.</span>position_i)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#09f;font-style:italic># check to see if the current position is an individual best</span>
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>err_i <span style=color:#555>&lt;</span> self<span style=color:#555>.</span>err_best_i <span style=color:#000;font-weight:700>or</span> self<span style=color:#555>.</span>err_best_i<span style=color:#555>==-</span><span style=color:#f60>1</span>:
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>pos_best_i<span style=color:#555>=</span>self<span style=color:#555>.</span>position_i
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>err_best_i<span style=color:#555>=</span>self<span style=color:#555>.</span>err_i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic># update new particle velocity</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>update_velocity</span>(self,pos_best_g):
</span></span><span style=display:flex><span>        w<span style=color:#555>=</span><span style=color:#f60>0.5</span>       <span style=color:#09f;font-style:italic># constant inertia weight (how much to weigh the previous velocity)</span>
</span></span><span style=display:flex><span>        c1<span style=color:#555>=</span><span style=color:#f60>1</span>        <span style=color:#09f;font-style:italic># cognative constant</span>
</span></span><span style=display:flex><span>        c2<span style=color:#555>=</span><span style=color:#f60>2</span>        <span style=color:#09f;font-style:italic># social constant</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
</span></span><span style=display:flex><span>            r1<span style=color:#555>=</span>random<span style=color:#555>.</span>random()
</span></span><span style=display:flex><span>            r2<span style=color:#555>=</span>random<span style=color:#555>.</span>random()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            vel_cognitive<span style=color:#555>=</span>c1<span style=color:#555>*</span>r1<span style=color:#555>*</span>(self<span style=color:#555>.</span>pos_best_i[i]<span style=color:#555>-</span>self<span style=color:#555>.</span>position_i[i])
</span></span><span style=display:flex><span>            vel_social<span style=color:#555>=</span>c2<span style=color:#555>*</span>r2<span style=color:#555>*</span>(pos_best_g[i]<span style=color:#555>-</span>self<span style=color:#555>.</span>position_i[i])
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>velocity_i[i]<span style=color:#555>=</span>w<span style=color:#555>*</span>self<span style=color:#555>.</span>velocity_i[i]<span style=color:#555>+</span>vel_cognitive<span style=color:#555>+</span>vel_social
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic># update the particle position based off new velocity updates</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>update_position</span>(self,bounds):
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
</span></span><span style=display:flex><span>            self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>self<span style=color:#555>.</span>position_i[i]<span style=color:#555>+</span>self<span style=color:#555>.</span>velocity_i[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic># adjust maximum position if necessary</span>
</span></span><span style=display:flex><span>            <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>position_i[i]<span style=color:#555>&gt;</span>bounds[i][<span style=color:#f60>1</span>]:
</span></span><span style=display:flex><span>                self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>bounds[i][<span style=color:#f60>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic># adjust minimum position if neseccary</span>
</span></span><span style=display:flex><span>            <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>position_i[i] <span style=color:#555>&lt;</span> bounds[i][<span style=color:#f60>0</span>]:
</span></span><span style=display:flex><span>                self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>bounds[i][<span style=color:#f60>0</span>]
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>PSO</span>():
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> __init__(self,costFunc,x0,bounds,num_particles,maxiter):
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>global</span> num_dimensions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        num_dimensions<span style=color:#555>=</span><span style=color:#366>len</span>(x0)
</span></span><span style=display:flex><span>        err_best_g<span style=color:#555>=-</span><span style=color:#f60>1</span>                   <span style=color:#09f;font-style:italic># best error for group</span>
</span></span><span style=display:flex><span>        pos_best_g<span style=color:#555>=</span>[]                   <span style=color:#09f;font-style:italic># best position for group</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#09f;font-style:italic># establish the swarm</span>
</span></span><span style=display:flex><span>        swarm<span style=color:#555>=</span>[]
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
</span></span><span style=display:flex><span>            swarm<span style=color:#555>.</span>append(Particle(x0))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#09f;font-style:italic># begin optimization loop</span>
</span></span><span style=display:flex><span>        i<span style=color:#555>=</span><span style=color:#f60>0</span>
</span></span><span style=display:flex><span>        <span style=color:#069;font-weight:700>while</span> i <span style=color:#555>&lt;</span> maxiter:
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>#print i,err_best_g</span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic># cycle through particles in swarm and evaluate fitness</span>
</span></span><span style=display:flex><span>            <span style=color:#069;font-weight:700>for</span> j <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
</span></span><span style=display:flex><span>                swarm[j]<span style=color:#555>.</span>evaluate(costFunc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#09f;font-style:italic># determine if current particle is the best (globally)</span>
</span></span><span style=display:flex><span>                <span style=color:#069;font-weight:700>if</span> swarm[j]<span style=color:#555>.</span>err_i <span style=color:#555>&lt;</span> err_best_g <span style=color:#000;font-weight:700>or</span> err_best_g <span style=color:#555>==</span> <span style=color:#555>-</span><span style=color:#f60>1</span>:
</span></span><span style=display:flex><span>                    pos_best_g<span style=color:#555>=</span><span style=color:#366>list</span>(swarm[j]<span style=color:#555>.</span>position_i)
</span></span><span style=display:flex><span>                    err_best_g<span style=color:#555>=</span><span style=color:#366>float</span>(swarm[j]<span style=color:#555>.</span>err_i)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic># cycle through swarm and update velocities and position</span>
</span></span><span style=display:flex><span>            <span style=color:#069;font-weight:700>for</span> j <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
</span></span><span style=display:flex><span>                swarm[j]<span style=color:#555>.</span>update_velocity(pos_best_g)
</span></span><span style=display:flex><span>                swarm[j]<span style=color:#555>.</span>update_position(bounds)
</span></span><span style=display:flex><span>            i<span style=color:#555>+=</span><span style=color:#f60>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#09f;font-style:italic># print final results</span>
</span></span><span style=display:flex><span>        <span style=color:#366>print</span> <span style=color:#c30>&#39;FINAL:&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#366>print</span> pos_best_g
</span></span><span style=display:flex><span>        <span style=color:#366>print</span> err_best_g
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> __name__ <span style=color:#555>==</span> <span style=color:#c30>&#34;__PSO__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#--- RUN ----------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>initial<span style=color:#555>=</span>[<span style=color:#f60>5</span>,<span style=color:#f60>5</span>]               <span style=color:#09f;font-style:italic># initial starting location [x1,x2...]</span>
</span></span><span style=display:flex><span>bounds<span style=color:#555>=</span>[(<span style=color:#555>-</span><span style=color:#f60>10</span>,<span style=color:#f60>10</span>),(<span style=color:#555>-</span><span style=color:#f60>10</span>,<span style=color:#f60>10</span>)]  <span style=color:#09f;font-style:italic># input bounds [(x1_min,x1_max),(x2_min,x2_max)...]</span>
</span></span><span style=display:flex><span>PSO(func1,initial,bounds,num_particles<span style=color:#555>=</span><span style=color:#f60>15</span>,maxiter<span style=color:#555>=</span><span style=color:#f60>30</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#--- END ----------------------------------------------------------------------+</span>
</span></span></code></pre></div><p>I hope this was helpful! If you want, you can download the entire code from my GitHub (<a target=_blank href=https://github.com/nathanrooy/Particle-Swarm-Optimization-with-Python/blob/master/simple-particle-swarm-optimization.py>here</a>). Check back later for my post on a more advanced particle swarm optimization routine.</p></div></div></body></html>