<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=author content="Nathan Rooy"><meta name=copyright content="Nathan A. Rooy"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=language content="en"><meta http-equiv=content-language content="en-gb"><link rel=icon type=image/png href=/favicon/favicon.png><script defer data-domain=nathanrooy.github.io src=https://plausible.io/js/plausible.js></script><script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><meta property="og:title" content="Particle Swarm Optimization from Scratch with Python"><meta property="og:description" content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://nathanrooy.github.io/posts/2016-08-17/simple-particle-swarm-optimization-with-python/"><meta property="og:site_name" content="nathanrooy.github.io"><meta property="og:image" content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><title>Particle Swarm Optimization from Scratch with Python</title><link rel=canonical href=https://nathanrooy.github.io/posts/2016-08-17/simple-particle-swarm-optimization-with-python/ itemprop=url><base href=https://nathanrooy.github.io/posts/2016-08-17/simple-particle-swarm-optimization-with-python/><meta itemprop=name content="Particle Swarm Optimization from Scratch with Python | Nathan Rooy"><meta itemprop=description content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python"><meta itemprop=image content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><meta name=description content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python"><meta name=application-name content="Particle Swarm Optimization from Scratch with Python | Nathan Rooy"><meta name=keywords content="particle,swarm,optimization,,python,,tutorial,,evolutionary,optimization,,optimization"><meta name=twitter:card content="nathanrooy.github.io"><meta name=twitter:url content="https://nathanrooy.github.io/posts/2016-08-17/simple-particle-swarm-optimization-with-python/"><meta name=twitter:title content="Particle Swarm Optimization from Scratch with Python | Nathan Rooy"><meta name=twitter:description content="A tutorial that covers the basics of particle swarm optimization while implementing a simplified, barebones version with Python"><meta name=twitter:image content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><link rel=alternate type=application/rss+xml href=https://nathanrooy.github.io/index.xml title="Nathan Rooy"><style>/*!normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:initial}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--main-text-color:#222;--main-text-weight:400;--text-bold:600;--font-family:"Figtree", sans-serif}body{-webkit-font-smoothing:antialiased}@font-face{font-family:figtree;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/figtree-v1-latin-regular.eot);src:local(''),url(/fonts/figtree-v1-latin-regular.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-regular.woff2)format('woff2'),url(/fonts/figtree-v1-latin-regular.woff)format('woff'),url(/fonts/figtree-v1-latin-regular.ttf)format('truetype'),url(/fonts/figtree-v1-latin-regular.svg#Figtree)format('svg')}@font-face{font-family:figtree;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/figtree-v1-latin-600.eot);src:local(''),url(/fonts/figtree-v1-latin-600.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-600.woff2)format('woff2'),url(/fonts/figtree-v1-latin-600.woff)format('woff'),url(/fonts/figtree-v1-latin-600.ttf)format('truetype'),url(/fonts/figtree-v1-latin-600.svg#Figtree)format('svg')}.home-page{font-family:var(--font-family);color:var(--main-text-color);margin-top:0}.home-page ul li{margin-bottom:.3rem}.home-page ul a{color:var(--main-text-color)}.post-li-title{width:95%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;float:left}.post-li-date{float:left;padding-bottom:1em;font-size:16px;color:#a9a9a9}@media only screen and (min-width:501px){.wrapper{max-width:660px;margin:0 auto;padding:1rem}.container{margin-top:10rem}.post-li-title{font-size:19px}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.6em;margin-top:0}.post-li{overflow:hidden}}@media only screen and (max-width:950px){.container{margin-top:0}}@media only screen and (max-width:500px){.wrapper{margin:0 auto}.container{margin:2rem 1rem 1rem}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.5em;margin-top:.2rem}.post-li{overflow:hidden}}.nyc-progress-image{margin-top:-1rem}.strava-grid{padding-top:1rem}.language-python{font-size:.8rem;line-height:0}.highlight{margin-bottom:1rem}.personal-social-media{text-align:center}.personal-social-media a{display:inline-block;padding-left:5px;padding-right:5px}.about h3{margin-top:0;padding-top:0}.about li{margin-bottom:0;padding-bottom:0}.about-ul li{margin-bottom:.5rem}footer{padding-bottom:6rem;font-family:var(--font-family);font-size:.75em;color:#999;margin-top:3rem;line-height:1.2rem}footer a{color:#555;font-weight:var(--main-text-weight)}footer a:hover{text-decoration:underline;color:#555}footer a:visited{color:#555}.footnotes{line-height:1rem;font-size:15px;margin-top:1em}.footnotes hr{display:none}.footnotes li p{line-height:1rem;margin-bottom:0}.footnotes ol{list-style:none;counter-reset:list;padding-left:2.5em;font-size:15px}.footnotes ol>li{list-style:none;position:relative}.footnotes ol>li:before{counter-increment:list;content:"[" counter(list)"] ";position:absolute;left:-2.5em;font-size:15px}ul.flat{margin:0;padding:0}ul.flat li{display:inline-block;list-style:none;margin-left:0}.markdown .post-update{background-color:#f2f2f2;border-left:10px solid;border-color:#e74c3c;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:1rem;margin-left:0;margin-right:0;margin-bottom:2rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.highlighter-rouge{position:relative;font-size:.75rem;color:var(--main-text-color);border:1px solid;border-color:#e6e6e6;border-radius:3px;background-color:#f2f2f2;padding:.1rem .2rem}.figcaption{font-size:.8rem;padding-bottom:1rem}.markdown .photoset-grid-lightbox{margin-bottom:1rem}.markdown{font-family:var(--font-family);color:var(--main-text-color);padding-bottom:3rem}.markdown ol{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;padding-bottom:0;line-height:1.2rem;padding-right:2em;width:85%;margin-block-end:.25em}.markdown ol li{padding-bottom:.75em}.markdown p{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;margin-bottom:1rem;line-height:1.7rem;letter-spacing:.02rem}.markdown blockquote{background-color:#f2f2f2;border-left:10px solid;border-color:#2dad60;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:0;margin-left:0;margin-right:0;margin-bottom:1rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.markdown blockquote p{margin-bottom:0}.markdown h2{font-family:figtree;font-size:1.1rem;font-weight:var(--text-bold);margin-bottom:.4em}*+h2{padding-top:2rem}.markdown .ul-style-b li{margin-bottom:.5rem;font-size:16px}.TLDR{font-family:var(--font-family);padding-top:0;margin-top:0;padding-bottom:4rem;margin-bottom:0;font-size:1.1rem;line-height:1.7rem;font-weight:var(--main-text-weight);letter-spacing:.02rem}table{width:100%;font-size:14px;letter-spacing:-.01em;border-collapse:collapse;margin-bottom:2em;margin-top:2em;font-weight:var(--main-text-weight);line-height:1.2rem}table th{text-align:left}table thead{border-bottom:1px solid var(--main-text-color);line-height:1.4em}.post-header h1{font-weight:var(--main-text-weight);font-size:2rem;font-family:var(--font-family);color:var(--main-text-color);line-height:2.4rem}.post ul li{margin-bottom:10px}.post ul li p{display:inline}.post .post-header{margin-bottom:5rem}.post .post-header .title{margin:0}.post .post-header .meta{padding-left:0;margin-top:10px}.post .post-header a{color:#999}.post .post-header a:hover{text-decoration:underline}.post .post-header a:visited{color:#999}.separator{display:flex;align-items:center;text-align:center}.separator::before,.separator::after{content:'';flex:1;border-bottom:1px solid #000}.separator:not(:empty)::before{margin-right:.25em}.separator:not(:empty)::after{margin-left:.25em}a{text-decoration:none;color:#0955b5}a:hover{text-decoration:underline}a:visited{color:#205caa}::selection{background:#fff9c4;text-shadow:none}img{margin:1.5em auto;max-width:100%;display:block}a img{border:none}figure{margin:0;text-align:center}ul{padding-left:15px}ul{list-style:disc inside}.markdown ul li{font-size:15px}.highlight pre{margin-bottom:0;margin-top:0;padding:20px;background-color:initial!important;overflow:auto;word-wrap:normal;white-space:pre}.highlight{background:0 0;background-color:#fafafa}.meta{font-family:var(--font-family);font-size:.8rem;color:#999;margin-bottom:4px}.list .posts .post .meta{margin-bottom:0;margin-left:5px}.markdown .photoset-grid-lightbox{margin-bottom:1rem}table .katex-display{margin-top:.2rem;margin-bottom:.2rem}.post ul li .katex-display{display:inline-block;list-style:none;margin-left:0;margin-bottom:0;line-height:0;padding:0}@media only screen and (min-width:501px){#burger{padding-left:2rem;padding-top:2rem}}@media only screen and (max-width:950px){#burger{padding-left:1rem;padding-top:1rem;padding-bottom:1.5rem}}@media only screen and (max-width:500px){#burger{padding-left:1rem;padding-top:1rem}}#burger{font-family:var(--font-family);font-weight:400;color:#a9a9a9;font-size:1.5rem}#burger a{display:inline-block;padding-right:.5rem;padding-bottom:.3rem;vertical-align:bottom}#burger label{cursor:pointer}#burger label:hover{color:var(--main-text-color)}#nav-icons{padding-left:1rem}#nav-icons img{height:20px;margin:0;padding:0}#l1-val{position:relative;top:-.12rem}#l2-val{position:relative;top:-.2rem;padding-left:.1rem;padding-right:.1rem}#burger-cbox{display:none}#label-1{display:inline-block}#label-2{display:none}#burger-cbox:not(:checked)~#nav-icons{display:none}#burger-cbox:checked~#nav-icons{display:inline-block}#burger-cbox:checked~#label-1{display:none}#burger-cbox:checked~#label-2{display:inline-block;color:var(--main-text-color)}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><div class=header><nav role=navigation><div id=burger><input type=checkbox id=burger-cbox autocomplete=off>
<label id=label-1 for=burger-cbox><span>[</span><span id=l1-val>+</span><span>]</span></label>
<label id=label-2 for=burger-cbox><span>[</span><span id=l2-val>x</span><span>]</span></label><div id=nav-icons><a href=/><img src=/icons/home_feather.svg alt="home page icon"></a>
<a href=/reading><img src=/icons/book.svg alt="reading icon"></a>
<a href=/nyc_biking><img src=/icons/bicycle.svg alt="biking page icon"></a>
<a href=/about><img src=/icons/user_feather.svg alt="about page icon"></a>
<a href=/index.xml><img src=/icons/rss_feather_black.svg alt="rss page icon"></a></div></div></nav></div><div class="container wrapper post"><div class=post-header><h1 class=title>Particle Swarm Optimization from Scratch with Python</h1><div class=meta><a href=/>Nathan Rooy</a> | August 17, 2016</div></div><div class=markdown><p>Particle swarm optimization (<a target=_blank href=https://en.wikipedia.org/wiki/Particle_swarm_optimization>PSO</a>) is one of those rare tools that’s comically simple to code and implement while producing bizarrely good results. Developed in 1995 by Eberhart and Kennedy, PSO is a biologically inspired optimization routine designed to mimic birds flocking or fish schooling. I’ll occasionally use PSO for <a target=_blank href=https://en.wikipedia.org/wiki/Computational_fluid_dynamics>CFD</a> based aerodynamic shape optimization, but more often than not, it’s for a machine learning project. PSO is not guaranteed to find the global minimum, but it does a solid job in challenging, high dimensional, non-convex, non-continuous environments. In this short introductory tutorial, I’ll demonstrate PSO in its absolute simplest form. At a later date, I’ll create another PSO tutorial featuring a more advanced implementation.</p><p>Below, are the only two equations that make up a bare bones PSO algorithm. As a heads up, “k” references the current iteration, therefore “k+1″ implies the next iteration.</p><p>Particle position:</p><p><span class=math>\[ x_{k+1}^i = x_{k}^i + v_{k+1}^i \]</span></p><p>Particle velocity:</p><p><span class=math>\[ v_{k+1}^i = w_k v_k^i + c_1 r_1 \left(p_k^i - x_k^i\right) + c_2 r_2 \left(p_k^g - x_k^i\right) \]</span></p><p>Where:</p><p><center><table style=width:60%;line-height:2.5em;max-width:400px><col width=40%><col width=60%><thead><th><strong>Variable</strong></th><th><strong>Definition</strong></th></thead><tbody><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( x_k^i \)</span></td><td>particle position</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( v_k^i \)</span></td><td>particle position</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( p_k^i \)</span></td><td>best individual particle position</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( p_k^g \)</span></td><td>best swarm position</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( w_k \)</span></td><td>constant inertia weight</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( c_1, c_2 \)</span></td><td>cognitive and social parameters respectively</td></tr><tr><td><equation class=has-jax style=padding-left:30px><span class=math>\( r_1, r_2 \)</span></td><td>random numbers between 0 and 1</td></tr></tbody></table></center></p><p>From the particle velocity equation, two important groups emerge:<ol class=ul-style-b><li>social term: <span class=math>\( c_2 r_2 \left(p_k^g - x_k^i\right) \)</span></li><li>cognitive term: <span class=math>\( c_1 r_1 \left(p_k^i - x_k^i\right) \)</span></li></ol>Using these two simple equations, the basic flow structure of a PSO routine is as follows:</p><p>A) Initialize<ol class=ul-style-b><li>Set constants: <span class=math>\( k_{max}, w_k, c_1, c_2 \)</span></li><li>Randomly initialize particle positions.</li><li>Randomly initialize particle velocities.</li><li>Set k=1 (iteration counter).</li></ol></p><p>B) Optimize<ol class=ul-style-b><li>Evaluate cost function <span class=math>\( f_k^i \)</span> at each particle position <span class=math>\( x_k^i \)</span></li><li>If <span class=math>\( f_k^i \le f_{best}^i \)</span> then <span class=math>\( f_{best}^i = f_k^i \)</span> and <span class=math>\( p_k^i = x_k^i \)</span>.</li><li>If <span class=math>\( f_k^i \le f_{best}^g \)</span> then <span class=math>\( f_{best}^g = f_k^i \)</span> and <span class=math>\( p_k^g = x_k^i \)</span>.</li><li>If stopping condition is satisfied, go to C.</li><li>Update all particle velocities.</li><li>Update all particle positions.</li><li>Increment k.</li><li>Go to B(1).</li></ol></p><p>C) Terminate</p><p>That’s it! It’s really that simple. The main concept behind PSO, which is evident from the particle velocity equation above, is that there is a constant balance between three distinct forces pulling on each particle:</p><ol class=ul-style-b><li>The particles previous velocity (inertia)</li><li>Distance from the individual particles’ best known position (cognitive force)</li><li>Distance from the swarms best known position (social force)</li></ol><p>These three forces are then weighted by <span class=math>\( w_k \)</span>, <span class=math>\( c_1 \)</span>, <span class=math>\( c_2 \)</span> and randomly perturbed by <span class=math>\( r_1 \)</span> and <span class=math>\( r_2 \)</span>. Thus depending on the weighting, either the swarms best location <span class=math>\( p_k^g \)</span> or the particles own best position <span class=math>\( p_k^i \)</span> will pull harder on the particle and dictate the overall direction. That’s assuming the particles initial velocity (or inertia) won’t cause the particle to wonder around. Often times, if you notice that the convergence is taking longer it’s because the particle inertia is weighted to heavily and should be reduced to speed up convergence. Keep in mind, that particle inertia is a double-edged-sword. If you're dealing with a noisy, highly multimodal cost function, too little inertia could result in the particles getting trapped at a local minimum, unable to climb out.</p><p>In vector form, these three forces can be seen below (vector magnitude represents the weight value of that specific force):</p><p><img alt=pso-vector-1 title=pso-vector-1 src=pso-vector-1.png>
<center class=figcaption>Figure 1: a high energy particle that will keep exploring the search space</center></p><p>We can see in the above example that the weighting of the particles inertia and individual best overpower the swarms influence. In this scenario, the particle will continue exploring the search space rather than converge on the swarm. As another example below:</p><p><img alt=pso-vector-2 title=pso-vector-2 src=pso-vector-2.png>
<center class=figcaption>Figure 2: a lazy particle that follows the herd</center></p><p>This time, the weighting assigned to the swarms influence overpowers the individual forces of the particle forcing it towards the swarm. This will result in a faster convergence, at the expense of not fully exploring the search space and potentially finding a better solution.</p><p>The implementation of a simple PSO routine in python is fairly straightforward. We are going to utilize some object-oriented programming and create a swarm of particles using a particle class. These particles will be monitored by a main optimization class. Below is the entire code:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
<span style=color:#09f;font-style:italic>#</span>
<span style=color:#09f;font-style:italic>#   Nathan A. Rooy</span>
<span style=color:#09f;font-style:italic>#   Simple Particle Swarm Optimization (PSO) with Python</span>
<span style=color:#09f;font-style:italic>#   July, 2016</span>
<span style=color:#09f;font-style:italic>#</span>
<span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>

<span style=color:#09f;font-style:italic>#--- IMPORT DEPENDENCIES ------------------------------------------------------+</span>

<span style=color:#069;font-weight:700>from</span> <span style=color:#0cf;font-weight:700>__future__</span> <span style=color:#069;font-weight:700>import</span> division
<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>random</span>
<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>math</span>

<span style=color:#09f;font-style:italic>#--- COST FUNCTION ------------------------------------------------------------+</span>

<span style=color:#09f;font-style:italic># function we are attempting to optimize (minimize)</span>
<span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>func1</span>(x):
    total<span style=color:#555>=</span><span style=color:#f60>0</span>
    <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#366>len</span>(x)):
        total<span style=color:#555>+=</span>x[i]<span style=color:#555>**</span><span style=color:#f60>2</span>
    <span style=color:#069;font-weight:700>return</span> total

<span style=color:#09f;font-style:italic>#--- MAIN ---------------------------------------------------------------------+</span>

<span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>Particle</span>:
    <span style=color:#069;font-weight:700>def</span> __init__(self,x0):
        self<span style=color:#555>.</span>position_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># particle position</span>
        self<span style=color:#555>.</span>velocity_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># particle velocity</span>
        self<span style=color:#555>.</span>pos_best_i<span style=color:#555>=</span>[]          <span style=color:#09f;font-style:italic># best position individual</span>
        self<span style=color:#555>.</span>err_best_i<span style=color:#555>=-</span><span style=color:#f60>1</span>          <span style=color:#09f;font-style:italic># best error individual</span>
        self<span style=color:#555>.</span>err_i<span style=color:#555>=-</span><span style=color:#f60>1</span>               <span style=color:#09f;font-style:italic># error individual</span>

        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
            self<span style=color:#555>.</span>velocity_i<span style=color:#555>.</span>append(random<span style=color:#555>.</span>uniform(<span style=color:#555>-</span><span style=color:#f60>1</span>,<span style=color:#f60>1</span>))
            self<span style=color:#555>.</span>position_i<span style=color:#555>.</span>append(x0[i])

    <span style=color:#09f;font-style:italic># evaluate current fitness</span>
    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>evaluate</span>(self,costFunc):
        self<span style=color:#555>.</span>err_i<span style=color:#555>=</span>costFunc(self<span style=color:#555>.</span>position_i)

        <span style=color:#09f;font-style:italic># check to see if the current position is an individual best</span>
        <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>err_i <span style=color:#555>&lt;</span> self<span style=color:#555>.</span>err_best_i <span style=color:#000;font-weight:700>or</span> self<span style=color:#555>.</span>err_best_i<span style=color:#555>==-</span><span style=color:#f60>1</span>:
            self<span style=color:#555>.</span>pos_best_i<span style=color:#555>=</span>self<span style=color:#555>.</span>position_i
            self<span style=color:#555>.</span>err_best_i<span style=color:#555>=</span>self<span style=color:#555>.</span>err_i

    <span style=color:#09f;font-style:italic># update new particle velocity</span>
    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>update_velocity</span>(self,pos_best_g):
        w<span style=color:#555>=</span><span style=color:#f60>0.5</span>       <span style=color:#09f;font-style:italic># constant inertia weight (how much to weigh the previous velocity)</span>
        c1<span style=color:#555>=</span><span style=color:#f60>1</span>        <span style=color:#09f;font-style:italic># cognative constant</span>
        c2<span style=color:#555>=</span><span style=color:#f60>2</span>        <span style=color:#09f;font-style:italic># social constant</span>

        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
            r1<span style=color:#555>=</span>random<span style=color:#555>.</span>random()
            r2<span style=color:#555>=</span>random<span style=color:#555>.</span>random()

            vel_cognitive<span style=color:#555>=</span>c1<span style=color:#555>*</span>r1<span style=color:#555>*</span>(self<span style=color:#555>.</span>pos_best_i[i]<span style=color:#555>-</span>self<span style=color:#555>.</span>position_i[i])
            vel_social<span style=color:#555>=</span>c2<span style=color:#555>*</span>r2<span style=color:#555>*</span>(pos_best_g[i]<span style=color:#555>-</span>self<span style=color:#555>.</span>position_i[i])
            self<span style=color:#555>.</span>velocity_i[i]<span style=color:#555>=</span>w<span style=color:#555>*</span>self<span style=color:#555>.</span>velocity_i[i]<span style=color:#555>+</span>vel_cognitive<span style=color:#555>+</span>vel_social

    <span style=color:#09f;font-style:italic># update the particle position based off new velocity updates</span>
    <span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>update_position</span>(self,bounds):
        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_dimensions):
            self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>self<span style=color:#555>.</span>position_i[i]<span style=color:#555>+</span>self<span style=color:#555>.</span>velocity_i[i]

            <span style=color:#09f;font-style:italic># adjust maximum position if necessary</span>
            <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>position_i[i]<span style=color:#555>&gt;</span>bounds[i][<span style=color:#f60>1</span>]:
                self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>bounds[i][<span style=color:#f60>1</span>]

            <span style=color:#09f;font-style:italic># adjust minimum position if neseccary</span>
            <span style=color:#069;font-weight:700>if</span> self<span style=color:#555>.</span>position_i[i] <span style=color:#555>&lt;</span> bounds[i][<span style=color:#f60>0</span>]:
                self<span style=color:#555>.</span>position_i[i]<span style=color:#555>=</span>bounds[i][<span style=color:#f60>0</span>]
                
<span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>PSO</span>():
    <span style=color:#069;font-weight:700>def</span> __init__(self,costFunc,x0,bounds,num_particles,maxiter):
        <span style=color:#069;font-weight:700>global</span> num_dimensions

        num_dimensions<span style=color:#555>=</span><span style=color:#366>len</span>(x0)
        err_best_g<span style=color:#555>=-</span><span style=color:#f60>1</span>                   <span style=color:#09f;font-style:italic># best error for group</span>
        pos_best_g<span style=color:#555>=</span>[]                   <span style=color:#09f;font-style:italic># best position for group</span>

        <span style=color:#09f;font-style:italic># establish the swarm</span>
        swarm<span style=color:#555>=</span>[]
        <span style=color:#069;font-weight:700>for</span> i <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
            swarm<span style=color:#555>.</span>append(Particle(x0))

        <span style=color:#09f;font-style:italic># begin optimization loop</span>
        i<span style=color:#555>=</span><span style=color:#f60>0</span>
        <span style=color:#069;font-weight:700>while</span> i <span style=color:#555>&lt;</span> maxiter:
            <span style=color:#09f;font-style:italic>#print i,err_best_g</span>
            <span style=color:#09f;font-style:italic># cycle through particles in swarm and evaluate fitness</span>
            <span style=color:#069;font-weight:700>for</span> j <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
                swarm[j]<span style=color:#555>.</span>evaluate(costFunc)

                <span style=color:#09f;font-style:italic># determine if current particle is the best (globally)</span>
                <span style=color:#069;font-weight:700>if</span> swarm[j]<span style=color:#555>.</span>err_i <span style=color:#555>&lt;</span> err_best_g <span style=color:#000;font-weight:700>or</span> err_best_g <span style=color:#555>==</span> <span style=color:#555>-</span><span style=color:#f60>1</span>:
                    pos_best_g<span style=color:#555>=</span><span style=color:#366>list</span>(swarm[j]<span style=color:#555>.</span>position_i)
                    err_best_g<span style=color:#555>=</span><span style=color:#366>float</span>(swarm[j]<span style=color:#555>.</span>err_i)

            <span style=color:#09f;font-style:italic># cycle through swarm and update velocities and position</span>
            <span style=color:#069;font-weight:700>for</span> j <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>0</span>,num_particles):
                swarm[j]<span style=color:#555>.</span>update_velocity(pos_best_g)
                swarm[j]<span style=color:#555>.</span>update_position(bounds)
            i<span style=color:#555>+=</span><span style=color:#f60>1</span>

        <span style=color:#09f;font-style:italic># print final results</span>
        <span style=color:#069;font-weight:700>print</span> <span style=color:#c30>&#39;FINAL:&#39;</span>
        <span style=color:#069;font-weight:700>print</span> pos_best_g
        <span style=color:#069;font-weight:700>print</span> err_best_g

<span style=color:#069;font-weight:700>if</span> __name__ <span style=color:#555>==</span> <span style=color:#c30>&#34;__PSO__&#34;</span>:
    main()

<span style=color:#09f;font-style:italic>#--- RUN ----------------------------------------------------------------------+</span>

initial<span style=color:#555>=</span>[<span style=color:#f60>5</span>,<span style=color:#f60>5</span>]               <span style=color:#09f;font-style:italic># initial starting location [x1,x2...]</span>
bounds<span style=color:#555>=</span>[(<span style=color:#555>-</span><span style=color:#f60>10</span>,<span style=color:#f60>10</span>),(<span style=color:#555>-</span><span style=color:#f60>10</span>,<span style=color:#f60>10</span>)]  <span style=color:#09f;font-style:italic># input bounds [(x1_min,x1_max),(x2_min,x2_max)...]</span>
PSO(func1,initial,bounds,num_particles<span style=color:#555>=</span><span style=color:#f60>15</span>,maxiter<span style=color:#555>=</span><span style=color:#f60>30</span>)

<span style=color:#09f;font-style:italic>#--- END ----------------------------------------------------------------------+</span></code></pre></div><p>I hope this was helpful! If you want, you can download the entire code from my GitHub (<a target=_blank href=https://github.com/nathanrooy/Particle-Swarm-Optimization-with-Python/blob/master/simple-particle-swarm-optimization.py>here</a>). Check back later for my post on a more advanced particle swarm optimization routine.</p></div><div class=separator><ul class=flat><li><a onclick="plausible('home-icon',{props:{method:'Particle Swarm Optimization from Scratch with Python'}})" href=/><img style=min-width:30px;position:relative;top:5px;width:20px;height:20px src=/icons/home_feather.svg alt="home page icon"></a></li><li><a onclick="plausible('about-icon',{props:{method:'Particle Swarm Optimization from Scratch with Python'}})" href=/about><img style=min-width:30px;position:relative;top:5px;width:20px;height:20px src=/icons/user_feather.svg alt="about page icon"></a></li><li><a onclick="plausible('rss-icon',{props:{method:'Particle Swarm Optimization from Scratch with Python'}})" href=/index.xml target=_blank><img style=min-width:30px;position:relative;top:5px;width:20px;height:20px src=/icons/rss_feather_black.svg alt="rss page icon"></a></li></ul></div></div><footer><center>&copy; <a href=/about>Nathan A. Rooy</a>.<br>Built with <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>.
Powered by <a target=_blank rel="noopener noreferrer" href=http://www.github.com>GitHub</a></center></footer></body></html>