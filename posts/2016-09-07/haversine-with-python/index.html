<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=author content="Nathan Rooy"><meta name=copyright content="Nathan A. Rooy"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=language content="en"><meta http-equiv=content-language content="en-gb"><link rel=icon type=image/png href=/favicon/favicon.png><meta name=google-site-verification content="vQ6uvoBDOPVq7u67m2fO8RWaxcqsoLrLzmR7CzEo-0k"><meta name=msvalidate.01 content="4903EB9C7ABD70347352DCFAEE0751F5"><meta name=yandex-verification content="d0b7b29586e133fc"><script async defer data-domain=nathanrooy.github.io src=https://plausible.io/js/plausible.js></script><title>Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)</title><link rel=canonical href=https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/ itemprop=url><base href=https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/><meta itemprop=name content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula) | Nathan Rooy"><meta itemprop=description content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)"><meta name=description content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)"><meta name=application-name content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula) | Nathan Rooy"><meta name=twitter:card content="nathanrooy.github.io"><meta name=twitter:url content="https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/"><meta name=twitter:title content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula) | Nathan Rooy"><meta name=twitter:description content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)"><meta property="og:title" content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)"><meta property="og:description" content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/"><meta property="og:site_name" content="nathanrooy.github.io"><meta itemprop=image content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><meta property="og:image" content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><meta name=twitter:image content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><meta name=twitter:image:src content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg"><link rel=alternate type=application/rss+xml href=https://nathanrooy.github.io/index.xml title="Nathan Rooy"><link rel=stylesheet type=text/css media=screen href=https://nathanrooy.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://nathanrooy.github.io/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><div class="container wrapper post"><div class=header><div style=width:100%;display:inline class=site-title><a style=display:inline href=https://nathanrooy.github.io/>Nathan Rooy</a>
<a style=float:right;padding-left:10px;display:inline target=_blank href=/index.xml title=rss><img style=display:inline;margin:0;vertical-align:bottom src=/icons/rss_feather.svg width=20 height=20 alt="rss icon"></a>
<a style=float:right;padding-left:10px;display:inline target=_blank href=https://github.com/nathanrooy/ title=github><img style=display:inline;margin:0;vertical-align:bottom src=/icons/github_feather.svg width=20 height=20 alt="github page icon"></a></div><hr style=width:100%;display:inline-block><nav class=nav><ul class=flat><li style=text-align:center;vertical-align:top><a href=/><img style=margin:0;padding:0;width:20px;height:20px src=/icons/home_feather.svg alt="home page icon"></a></li><li style=text-align:center;vertical-align:top><a href=/about><img style=margin:0;padding:0;width:20px;height:20px src=/icons/user_feather.svg alt="about page icon"></a></li><li style=text-align:center;vertical-align:top><a href=/nyc_biking><img style=margin:0;padding:0;height:20px;aspect-ratio:92/53 src=/icons/bicycle.svg alt="biking page icon"></a></li><li><a href=/favorites><img style=margin:0;padding:0;width:20px;height:20px src=/icons/trending-up_feather.svg alt="personal favorites icon"></a></li></ul></nav></div><div class=post-header><h1 class=title>Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)</h1><div class=meta>Posted: September 7, 2016</div></div><div class=markdown><p class=TLDR><strong>TL;DR</strong> - By making a few geometric assumptions, the Haversine formula provies an exceptionally simple way of calculating distance between two latitude/longitude pairs. This tutorial will show you how to implement your own version in Python.</p><p>A lot of my posts recently have focused on the analysis of spacial data coming from either the GPS on my phone (collected through Strava) or geo-tagged tweets. Because of this I ended up writing my own Python module for calculating the distance between two latitude/longitude pairs. This is accomplished using the <a target=_blank href=https://en.wikipedia.org/wiki/Haversine_formula>Haversine formula</a>. While more accurate methods exist for calculating the distance between two points on earths surface, the Haversine formula and Python implementation couldn’t be any simpler. Below is a breakdown of the Haversine formula.</p><p>Haversine:</p><p><span class=math>\[ a=\sin^2\left(\frac{\Delta\phi}{2}\right) +\cos(\phi_1)\cdot\cos(\phi_2)\cdot\sin^2\left(\frac{\Delta\lambda}{2}\right)\]</span></p><p>With:</p><p><span class=math>\[ c=2\cdot arctan2\left(\sqrt{a},\sqrt{1-a}\right) \]</span></p><p>and:</p><p><span class=math>\[ d=R\cdot c \]</span></p><p>Where:<p style=padding-left:1rem><span class=math>\( \phi \)</span> = latitude<br><span class=math>\( \lambda \)</span> = longitude<br><span class=math>\( R \)</span> = 6371 (Earth's mean radius in km)<br></p></p><p>Much of Haverines’ simplicity comes from the underlying assumption that Earth is a perfect sphere (which it isn’t…). Because of this, it can lead to errors of up to 0.5%. More accurate methods exist but at the expense of computational complexity. Below is the Python implementation:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
<span style=color:#09f;font-style:italic>#</span>
<span style=color:#09f;font-style:italic>#   Nathan A. Rooy</span>
<span style=color:#09f;font-style:italic>#   Haversine Formula</span>
<span style=color:#09f;font-style:italic>#   June, 2016</span>
<span style=color:#09f;font-style:italic>#</span>
<span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>

<span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>math</span>

<span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>Haversine</span>:
    <span style=color:#c30>&#39;&#39;&#39;
</span><span style=color:#c30>    use the haversine class to calculate the distance between
</span><span style=color:#c30>    two lon/lat coordnate pairs.
</span><span style=color:#c30>    output distance available in kilometers, meters, miles, and feet.
</span><span style=color:#c30>    example usage: Haversine([lon1,lat1],[lon2,lat2]).feet
</span><span style=color:#c30>    
</span><span style=color:#c30>    &#39;&#39;&#39;</span>
    <span style=color:#069;font-weight:700>def</span> __init__(self,coord1,coord2):
        lon1,lat1<span style=color:#555>=</span>coord1
        lon2,lat2<span style=color:#555>=</span>coord2
        
        R<span style=color:#555>=</span><span style=color:#f60>6371000</span>                               <span style=color:#09f;font-style:italic># radius of Earth in meters</span>
        phi_1<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat1)
        phi_2<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat2)

        delta_phi<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat2<span style=color:#555>-</span>lat1)
        delta_lambda<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lon2<span style=color:#555>-</span>lon1)

        a<span style=color:#555>=</span>math<span style=color:#555>.</span>sin(delta_phi<span style=color:#555>/</span><span style=color:#f60>2.0</span>)<span style=color:#555>**</span><span style=color:#f60>2</span><span style=color:#555>+</span>\
           math<span style=color:#555>.</span>cos(phi_1)<span style=color:#555>*</span>math<span style=color:#555>.</span>cos(phi_2)<span style=color:#555>*</span>\
           math<span style=color:#555>.</span>sin(delta_lambda<span style=color:#555>/</span><span style=color:#f60>2.0</span>)<span style=color:#555>**</span><span style=color:#f60>2</span>
        c<span style=color:#555>=</span><span style=color:#f60>2</span><span style=color:#555>*</span>math<span style=color:#555>.</span>atan2(math<span style=color:#555>.</span>sqrt(a),math<span style=color:#555>.</span>sqrt(<span style=color:#f60>1</span><span style=color:#555>-</span>a))
        
        self<span style=color:#555>.</span>meters<span style=color:#555>=</span>R<span style=color:#555>*</span>c                         <span style=color:#09f;font-style:italic># output distance in meters</span>
        self<span style=color:#555>.</span>km<span style=color:#555>=</span>self<span style=color:#555>.</span>meters<span style=color:#555>/</span><span style=color:#f60>1000.0</span>              <span style=color:#09f;font-style:italic># output distance in kilometers</span>
        self<span style=color:#555>.</span>miles<span style=color:#555>=</span>self<span style=color:#555>.</span>meters<span style=color:#555>*</span><span style=color:#f60>0.000621371</span>      <span style=color:#09f;font-style:italic># output distance in miles</span>
        self<span style=color:#555>.</span>feet<span style=color:#555>=</span>self<span style=color:#555>.</span>miles<span style=color:#555>*</span><span style=color:#f60>5280</span>               <span style=color:#09f;font-style:italic># output distance in feet</span>

<span style=color:#069;font-weight:700>if</span> __name__ <span style=color:#555>==</span> <span style=color:#c30>&#34;__Haversine__&#34;</span>:
    main()</code></pre></div><p>Example usage:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#555>&gt;&gt;&gt;</span> <span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>haversine</span>
<span style=color:#555>&gt;&gt;&gt;</span> Haversine([<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>],[<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>])<span style=color:#555>.</span>feet 
<span style=color:#f60>8.890493621837097</span>

<span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>feet 
<span style=color:#f60>8.890493621837097</span>

<span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>km 
<span style=color:#f60>0.0027098232942902385</span>

<span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>miles 
<span style=color:#f60>0.00168380561019642</span></code></pre></div><p>Note haversine script accepts the coordinates in both tuple “()” and list “[]” form. Additionally, the script can be downloaded from my GitHub located (<a target=_blank href=https://github.com/nathanrooy/spatial-analysis>here</a>).</p></div><div class=post-hr><hr></div></div><div class=footer><center>&copy; <a href=/about>Nathan A. Rooy</a>.<br>Built with <a target=_blank href=https://gohugo.io/>Hugo</a>.
Powered by <a target=_blank href=http://www.github.com>GitHub</a></center></div></body></html>