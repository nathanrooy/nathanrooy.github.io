<!doctype html><html lang=en><head><meta charset=utf-8><title>Nathan Rooy</title><meta content="Nathan Rooy" name=author><meta content="en" name=language><meta content="width=device-width,minimum-scale=1" name=viewport><meta content="nathanrooy.github.io" property="og:site_name"><meta content="nathanrooy.github.io" property="twitter:domain"><meta content="article" property="og:type"><meta content="https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/" property="og:url"><meta content="https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/" name=twitter:url><meta content="Nathan A. Rooy" name=copyright><meta content="summary_large_image" name=twitter:card><meta content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)" name=twitter:title><meta content="Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)" property="og:title"><meta content="Nathan A. Rooy | nathanrooy.github.io" name=description><meta content="Nathan A. Rooy | nathanrooy.github.io" name=twitter:description><meta content="Nathan A. Rooy | nathanrooy.github.io" property="og:description"><meta content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg" name=twitter:image><meta content="https://nathanrooy.github.io/about/DSC_3706-EDIT-BLOG-TINY.jpg" property="og:image"><link href=https://nathanrooy.github.io/index.xml rel=alternate type=application/rss+xml title="Nathan Rooy"><link href=/favicon/favicon.png rel=icon type=image/png><link href=/fonts/figtree-v1-latin-regular.woff2 rel=preload as=font type=font/woff2 crossorigin><link href=https://nathanrooy.github.io/posts/2016-09-07/haversine-with-python/ rel=canonical><script defer data-domain=nathanrooy.github.io src=https://plausible.io/js/script.tagged-events.js></script><style>/*!normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}:root{--main-text-color:#222;--main-text-weight:400;--text-bold:600;--font-family:"Figtree", sans-serif;--background-light:#F5F5F5}body{-webkit-font-smoothing:antialiased}@font-face{font-family:figtree;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/figtree-v1-latin-regular.eot);src:local(''),url(/fonts/figtree-v1-latin-regular.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-regular.woff2)format('woff2'),url(/fonts/figtree-v1-latin-regular.woff)format('woff'),url(/fonts/figtree-v1-latin-regular.ttf)format('truetype'),url(/fonts/figtree-v1-latin-regular.svg#Figtree)format('svg')}@font-face{font-family:figtree;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/figtree-v1-latin-600.eot);src:local(''),url(/fonts/figtree-v1-latin-600.eot?#iefix)format('embedded-opentype'),url(/fonts/figtree-v1-latin-600.woff2)format('woff2'),url(/fonts/figtree-v1-latin-600.woff)format('woff'),url(/fonts/figtree-v1-latin-600.ttf)format('truetype'),url(/fonts/figtree-v1-latin-600.svg#Figtree)format('svg')}.home-page{font-family:var(--font-family);color:var(--main-text-color);margin-top:0;padding-bottom:6rem}.home-page ul li{margin-bottom:.3rem}.home-page ul a{color:var(--main-text-color)}.post-li-title{width:95%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;float:left}.post-li-date{float:left;padding-bottom:1em;font-size:16px;color:#a9a9a9}@media only screen and (min-width:501px){.wrapper{max-width:660px;margin:0 auto;padding:1rem}.container{margin-top:6rem}.post-li-title{font-size:19px}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.6em;margin-top:0}.post-li{overflow:hidden}}@media only screen and (max-width:950px){.container{margin-top:0}}@media only screen and (max-width:500px){.wrapper{margin:0 auto}.container{margin:2rem 1rem 1rem}.post-ul{list-style-type:none;padding-left:0;list-style:none;line-height:1.5em;margin-top:.2rem}.post-li{overflow:hidden}}.nyc-progress-image{margin-top:-1rem}.strava-grid{padding-top:1rem}.language-python{font-size:.8rem;line-height:0}.highlight{margin-bottom:1rem}.markdown .footnotes hr{margin-top:4rem;margin-bottom:4rem;height:1px;border:none;color:var(--main-text-color);background-color:var(--main-text-color)}.markdown .footnotes ol{counter-reset:item;padding-left:0;padding-right:0;width:fit-content;color:#757575}.markdown .footnotes li{display:block;padding-bottom:0}.markdown .footnotes li:before{content:counter(item)". ";counter-increment:item;width:2em;display:inline-block;position:absolute}.markdown .footnotes li p{padding-left:2rem;line-height:1.25rem}.markdown .footnotes li a{color:#757575}.markdown .footnotes li a:hover{color:var(--main-text-color)}.inline-svg-equation{text-align:center;margin:1.5em auto;max-width:100%;display:block}ul.flat{margin:0;padding:0}ul.flat li{display:inline-block;list-style:none;margin-left:0}.markdown .post-update{background-color:var(--background-light);border-left:10px solid;border-color:#e74c3c;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:1rem;margin-left:0;margin-right:0;margin-bottom:2rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.highlighter-rouge{position:relative;font-size:.75rem;color:var(--main-text-color);border:1px solid;border-color:#e6e6e6;border-radius:3px;background-color:#f2f2f2;padding:.1rem .2rem}.figcaption{font-size:.8rem;padding-bottom:1rem}.markdown .photoset-grid-lightbox{margin-bottom:1rem}.markdown{font-family:var(--font-family);color:var(--main-text-color);padding-bottom:8rem}.markdown ol{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;padding-bottom:0;line-height:1.2rem;padding-right:2em;width:85%;margin-block-end:.25em}.markdown ol li{padding-bottom:.75em}.markdown p{font-weight:var(--main-text-weight);font-size:16px;margin-top:0;margin-bottom:1rem;line-height:1.7rem;letter-spacing:.02rem}.markdown blockquote{background-color:#f2f2f2;border-left:10px solid;border-color:#2dad60;padding-top:1.5rem;padding-left:1.5rem;padding-bottom:1.5rem;padding-right:1.5rem;margin-top:0;margin-left:0;margin-right:0;margin-bottom:1rem;line-height:1.5rem;font-weight:var(--main-text-weight);font-size:15px}.markdown blockquote p{margin-bottom:0}.markdown h2{font-family:figtree;font-size:1.2rem;font-weight:var(--text-bold);margin-bottom:.3em}*+h2{padding-top:2rem}.markdown .ul-style-b li{margin-bottom:.5rem;font-size:16px}.TLDR{font-family:var(--font-family);padding-top:0;margin-top:0;margin-bottom:0;font-size:1.1rem;line-height:1.7rem;font-weight:var(--main-text-weight);letter-spacing:.02rem}table{width:100%;font-size:14px;letter-spacing:-.01em;border-collapse:collapse;margin-bottom:2em;margin-top:2em;font-weight:var(--main-text-weight);line-height:1.2rem}table th{text-align:left}table thead{border-bottom:1px solid var(--main-text-color);line-height:1.4em}.post-header h1{font-weight:var(--main-text-weight);font-size:2.3rem;font-family:var(--font-family);color:var(--main-text-color);line-height:2.64rem}.post ul li{margin-bottom:10px}.post ul li p{display:inline}.post .post-header{margin-bottom:2.5rem}.post .post-header .title{margin:0}.post .post-header .meta{padding-left:0;margin-top:10px}.post .post-header a{color:#999}.post .post-header a:hover{text-decoration:underline}.post .post-header a:visited{color:#999}.post hr{margin-top:4rem;margin-bottom:4rem;height:1px;border:none;color:var(--main-text-color);background-color:var(--main-text-color)}a{text-decoration:none;color:#0955b5}a:hover{text-decoration:underline}a:visited{color:#205caa}::selection{background:#fff9c4;text-shadow:none}#map img{margin:0;max-width:100%;display:block}img{margin:1.5em auto;max-width:100%;display:block}a img{border:none}figure{margin:0;text-align:center}ul{padding-left:15px}ul{list-style:disc inside}.markdown ul li{font-size:15px}.highlight pre{margin-bottom:0;margin-top:0;padding:20px;background-color:transparent!important;overflow:auto;word-wrap:normal;white-space:pre}.highlight{background:0 0;background-color:#fafafa}.meta{font-family:var(--font-family);font-size:.8rem;color:#999;margin-bottom:4px}.list .posts .post .meta{margin-bottom:0;margin-left:5px}.markdown .photoset-grid-lightbox{margin-bottom:1rem}table .katex-display{margin-top:.2rem;margin-bottom:.2rem}.post ul li .katex-display{display:inline-block;list-style:none;margin-left:0;margin-bottom:0;line-height:0;padding:0}@media only screen and (min-width:501px){#burger{padding-left:2rem;padding-top:2rem}}@media only screen and (max-width:950px){#burger{padding-left:1rem;padding-top:1rem;padding-bottom:1.5rem}}@media only screen and (max-width:500px){#burger{padding-left:1rem;padding-top:1rem}}#burger{font-family:var(--font-family);font-weight:400;color:#a9a9a9;font-size:1.5rem}#burger a{display:inline-block;padding-right:.8rem}#burger label{cursor:pointer}#burger label:hover{color:var(--main-text-color)}#nav-icons{padding-left:.8rem}#nav-icons svg{max-height:20px;margin-bottom:-.05rem;color:var(--main-text-color)}#l1-val{position:relative;top:-.12rem}#l2-val{position:relative;top:-.2rem;padding-left:.1rem;padding-right:.1rem}#burger-cbox{display:none}#label-1{display:inline-block}#label-2{display:none}#burger-cbox:not(:checked)~#nav-icons{display:none}#burger-cbox:checked~#nav-icons{display:inline-block}#burger-cbox:checked~#label-1{display:none}#burger-cbox:checked~#label-2{display:inline-block;color:var(--main-text-color)}</style></head><body><div class=header><nav role=navigation><div id=burger><input type=checkbox id=burger-cbox autocomplete=off>
<label id=label-1 for=burger-cbox><span>[</span><span id=l1-val>+</span><span>]</span></label>
<label id=label-2 for=burger-cbox><span>[</span><span id=l2-val>x</span><span>]</span></label><div id=nav-icons><a class="plausible-event-name=burger+home" aria-label=Home href=/><svg xmlns="http://www.w3.org/2000/svg" id="home-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></a><a class="plausible-event-name=burger+reading" aria-label=Reading href=/reading><svg width="24" height="24" viewBox="0 0 23.809855 18.892912" id="svg5" inkscape:version="1.1 (c4e8f9e, 2021-05-24)" sodipodi:docname="book.svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" inkscape:pageshadow="2" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:document-units="mm" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom=".69130191" inkscape:cx="77.39021" inkscape:cy="446.98271" inkscape:window-width="1920" inkscape:window-height="1011" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="g39"/><defs id="defs2"/><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-6.352941,-30.26865)"><g id="g39" transform="matrix(0.26458333,0,0,0.26458333,5.0300244,26.48677)"><path class="st0" d="m92.22 22.9v59C74.24 76.35 61.26 78.85 54.73 81.04 59.2 76.64 68.54 70.55 84.16 74.14l1.69.39V21.42c2.17.29 4.3.77 6.37 1.48z" id="path11"/><path class="st0" d="M45.24 81.04C38.73 78.85 25.74 76.35 7.77 81.9v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.96 2.5 29.42 6.9z" id="path13"/><polygon points="48.86,85.63 48.82,85.58 48.91,85.63" id="polygon15"/><polygon points="51.17,85.58 51.13,85.63 50,85.63 51.09,85.62" id="polygon17"/><path d="m94.09 20.63c-2.68-1-5.45-1.65-8.24-2.02v-2.94l-1.08-.24c-17.8-4.09-28.32 3.81-32.9 8.68-.81.87-1.44 1.63-1.88 2.22C49.54 25.74 48.91 24.98 48.1 24.11c-4.58-4.87-15.11-12.76-32.9-8.68l-1.07.24v2.94c-2.8.38-5.57 1.02-8.24 2.02L5 20.97V85.7l1.81-.61c13.49-4.49 24.13-4.16 30.68-3.08 7.09 1.15 11.05 3.4 11.09 3.42l.23.14.09.06H50l1.09-.01.08-.05.23-.14c.05-.02 4-2.27 11.09-3.42 6.55-1.08 17.19-1.41 30.68 3.08l1.82.61V20.97zM7.78 81.89v-59c2.06-.71 4.2-1.19 6.37-1.48v53.11l1.68-.39c15.61-3.58 24.95 2.5 29.42 6.9-6.52-2.18-19.5-4.68-37.47.86zm40.76-1.3c-4.19-4.66-14.29-12.83-31.63-9.5v-53.2c11.11-2.28 18.93.38 24.02 3.66 2.6 1.68 4.48 3.52 5.71 4.95 1.14 1.32 1.73 2.28 1.82 2.43l.08.15zm2.76.17V29.34l.24-.4c.09-.16.68-1.12 1.82-2.44 1.23-1.43 3.11-3.27 5.71-4.94 5.08-3.29 12.91-5.95 24.02-3.67v53.2C65.54 67.72 55.4 76.13 51.3 80.76zm40.92 1.13C74.24 76.34 61.26 78.84 54.73 81.03 59.2 76.63 68.54 70.54 84.16 74.13l1.69.39v-53.1c2.16.29 4.3.77 6.37 1.48z" id="path19"/></g></g><style id="style9">.st0{fill:none}</style></svg></a><a class="plausible-event-name=burger+nycbike" aria-label="NYC Bike Exploring" href=/nyc_biking><svg viewBox="0 0 91.5 52.5" width="32" height="24" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><g transform="matrix(-1,0,0,1,95.8,-23.9)"><path d="m78 40.6c-3.8.0-7.3 1.2-10.2 3.2l-7.4-9.4 2.9-8.5H67c.6.0 1-.4 1-1s-.4-1-1-1H54.8c-.6.0-1 .4-1 1s.4 1 1 1h6.3l-2.3 6.7c-.2-.2-.4-.3-.7-.3H32l2.2-6.4h5.7c.6.0 1-.4 1-1s-.4-1-1-1h-6.4c-.4.0-.8.3-.9.7l-5.7 16.8c-1.5-.4-3.1-.7-4.8-.7-9.8.0-17.8 8-17.8 17.8s8 17.8 17.8 17.8 17.8-8 17.8-17.8c0-7.5-4.6-13.9-11.2-16.5l2.6-7.6 19 24.4c.1.3.3.6.6.7.1.0.2.1.3.1h.1 8.9c.5 9.4 8.3 16.8 17.8 16.8 9.8.0 17.8-8 17.8-17.8s-8-18-17.8-18zM37.8 58.4c0 8.7-7.1 15.8-15.8 15.8S6.2 67.1 6.2 58.4 13.3 42.6 22 42.6c1.4.0 2.8.2 4.1.6L21 58.1c-.2.5.1 1.1.6 1.3.1.0.2.1.3.1.4.0.8-.3.9-.7l5.1-14.9c5.9 2.2 9.9 7.9 9.9 14.5zm29.7-11.8L76 57.4H62.2c.3-4.3 2.2-8.1 5.3-10.8zm-16.7 9.6-17.1-22h24l.4.5zm1.8 1.2 7.1-20.8 6.6 8.4c-3.5 3.1-5.7 7.4-6 12.4zM78 74.2c-8.4.0-15.2-6.6-15.8-14.8H78c.4.0.7-.2.9-.6.2-.3.1-.8-.1-1.1L69 45.4c2.5-1.8 5.6-2.8 8.9-2.8 8.7.0 15.8 7.1 15.8 15.8s-7 15.8-15.7 15.8z"/></g></svg></a><a class="plausible-event-name=burger+about" aria-label=About href=/about><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" id="about-icon"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></a><a class="plausible-event-name=burger+rss" aria-label=RSS href=/index.xml><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 24" fill="none" stroke="#444" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss" id="rss-icon"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></div></nav></div><div class="container wrapper post"><div class=post-header><h1 class=title>Calculating the Distance Between Two GPS Coordinates with Python (Haversine Formula)</h1></div><p class=TLDR><strong>TL;DR</strong> - By making a few geometric assumptions, the Haversine formula provides an exceptionally simple way of calculating the distance between two latitude/longitude pairs. This tutorial will show you how to implement your own version in Python.</p><hr><div class=markdown><p>A lot of my posts recently have focused on the analysis of spatial data coming from either the GPS on my phone (collected through Strava) or geo-tagged tweets. Because of this I ended up writing my own Python module for calculating the distance between two latitude/longitude pairs. This is accomplished using the <a target=_blank href=https://en.wikipedia.org/wiki/Haversine_formula>Haversine formula</a>. While more accurate methods exist for calculating the distance between two points on earths surface, the Haversine formula and Python implementation couldn’t be any simpler. Below is a breakdown of the Haversine formula.</p><p>Haversine:</p><div class=inline-svg-equation style=text-align:left;padding-left:2rem><svg xmlns="http://www.w3.org/2000/svg" width="374.536" height="43.424" viewBox="0 -1449.5 20693.1 2399" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-I-61" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/><path id="MJX-5-TEX-N-3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/><path id="MJX-5-TEX-N-73" d="M295 316q0 40-27 69t-78 29q-36 0-62-13-30-19-30-52-1-5 0-13t16-24 43-25q18-5 44-9t44-9 32-13q17-8 33-20t32-41 17-62q0-62-38-102T198-10h-8q-52 0-96 36l-8-7-9-9Q71 4 65-1L54-11H46 42q-3 0-9 6V74v58q0 21 2 25t10 5h9q12 0 16-4t5-12 7-27 19-42q35-51 97-51 97 0 97 78 0 29-18 47-20 24-83 36t-83 23q-36 17-57 46T33 318q0 39 17 66t43 40 50 18 44 5h11q40 0 70-15l15-8 9 7q10 9 22 17h8 4q3 0 9-6V310l-6-6H301q-6 6-6 12z"/><path id="MJX-5-TEX-N-69" d="M69 609q0 28 18 44t44 16q23-2 40-17t17-43q0-30-17-45t-42-15-42 15-18 45zM247 0Q232 3 143 3q-11 0-37 0T56 1L34 0H26V46H42q28 0 49 3 9 4 11 11t2 42V205v88q0 52-2 66T88 378q-14 7-47 7H30v23q0 23 2 23l10 1q10 1 28 2t36 2q17 1 36 2t29 3 11 1h3V62q5-10 12-12t35-4h23V0h-8z"/><path id="MJX-5-TEX-N-6E" d="M41 46H55q39 0 47 14v8q0 9 0 23t0 31 1 39 0 42q0 31 0 66t-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3V402q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q114-4 127-113 1-7 1-139V104q0-38 2-45t11-10q21-3 49-3h16V0h-8L510 1q-23 1-50 1T422 3Q319 3 310 0h-8V46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V168 108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8L234 1q-24 1-51 1T145 3Q42 3 33 0H25V46H41z"/><path id="MJX-5-TEX-N-32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/><path id="MJX-5-TEX-N-2061"/><path id="MJX-5-TEX-S3-28" d="M701-940q0-3-6-9H664q-2 2-28 27t-45 43-54 61-62 81-63 101-62 125-55 149-45 176T221 17 209 251q0 711 364 1110 23 25 43 44t33 32 15 13h31q6-6 6-9 0-5-20-26t-52-59-72-95-81-143-76-191-60-252-32-316q-2-38-2-109 0-389 94-680T690-924q11-12 11-16z"/><path id="MJX-5-TEX-N-394" d="M51 0q-5 4-5 7 0 2 169 350T388 709q3 7 28 7 23 0 28-7 3-4 172-352T786 7q0-3-5-7H51zM507 344 384 596 137 92l246-1H630q0 2-123 253z"/><path id="MJX-5-TEX-I-3D5" d="M409 688q4 6 12 6h8 13q6-6 6-8 0-7-30-123-7-28-14-59t-12-46l-4-16q0-1 9-1t32-6 48-17q44-21 73-61t29-97-31-109-77-86-97-54-95-21h-4l-24-95q-6-23-13-55-8-32-11-38t-12-7h-6q-20 0-20 7 0 5 22 95l23 92q0 1-8 1-5 0-20 2T161 6 107 36 62 89 43 171q0 60 33 113t81 86 97 52 88 19q5 0 6 4l30 122q31 119 31 121zM122 150q0-34 12-59t33-38 36-18 34-8h7l93 377q-4 0-11-1t-29-8-42-16-44-29-41-46q-18-28-33-67-15-46-15-87zM5e2 282q0 38-16 65t-40 38-39 15-24 4h-3L332 217 284 29q0-2 1-2 8 0 32 6t40 14q43 19 74 53t44 70 19 64 6 48z"/><path id="MJX-5-TEX-S3-29" d="M34 1438q0 8 3 10t13 2h6H71q2-2 28-27t45-43 54-61 62-81 63-101 62-124 55-149 45-176 29-203 12-234q0-117-7-198-47-572-357-913-23-25-43-44T86-936 71-949H56q-13 0-17 2t-5 10q54 54 106 124Q428-430 428 251q0 202-26 377T338 922t-93 224-1e2 163-99 116q-2 2-4 4t-3 4-3 3l-2 2z"/><path id="MJX-5-TEX-N-2B" d="M56 237t0 13 14 20H369V420l1 150q10 13 19 13 13 0 20-15V270H707q15-8 15-20t-15-20H409V-68q-8-14-18-14h-2-2q-12 0-18 14V230H70q-14 7-14 20z"/><path id="MJX-5-TEX-N-63" d="M370 305t-21 0-36 15-16 38q0 23 15 38 5 5 5 6t-10 2q-26 4-49 4-49 0-80-32-47-47-47-157 0-82 31-129 41-61 110-61 41 0 66 26t36 62q2 8 5 10t16 2h14q6-6 6-9 0-4-4-16T395 71 366 33 318 2 249-11Q163-11 99 53T34 214q0 104 65 169t151 65 120-27 34-64q0-23-17-37z"/><path id="MJX-5-TEX-N-6F" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10Q153-10 91 57T28 214zM250 30q122 0 122 163v32 25q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92V226q0-96 19-135 32-61 105-61z"/><path id="MJX-5-TEX-N-28" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h13 4q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193T184 58 225-81t49-86 42-53 17-21q0-9-15-9h-3-13l-28 24Q180-141 137-14T94 250z"/><path id="MJX-5-TEX-N-31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/><path id="MJX-5-TEX-N-29" d="M60 749l4 1q5 0 10 0H86l28-24q94-85 137-212t43-264q0-68-10-131T261 12 224-76t-38-67-41-51-32-33-23-19q-3-3-4-4H74q-8 0-11 0t-5 3-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/><path id="MJX-5-TEX-N-22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/><path id="MJX-5-TEX-I-3BB" d="M166 673q0 12 17 21h19q90-3 114-50 6-15 57-158T474 207 524 67q7-20 13-33t9-19 5-9 4-4 1-4-6-9H482Q457 3 450 18T399 152L354 277l-14-15q-13-16-47-55t-57-66q-25-29-62-72Q123 9 111-1T83-12Q47-12 47 20q0 17 14 32T199 187q30 29 67 65t55 54l17 16q0 1-50 140T234 612q-20 45-51 45-17 0-17 16z"/></defs><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-I-61"/></g><g data-mml-node="mo" transform="translate(806.8, 0)"><use xlink:href="#MJX-5-TEX-N-3D"/></g><g data-mml-node="msup" transform="translate(1862.6, 0)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-N-73"/><use xlink:href="#MJX-5-TEX-N-69" transform="translate(394, 0)"/><use xlink:href="#MJX-5-TEX-N-6E" transform="translate(672, 0)"/></g><g data-mml-node="mn" transform="translate(1228, 413) scale(0.707)"><use xlink:href="#MJX-5-TEX-N-32"/></g></g><g data-mml-node="mo" transform="translate(3494.1, 0)"><use xlink:href="#MJX-5-TEX-N-2061"/></g><g data-mml-node="mrow" transform="translate(3494.1, 0)"><g data-mml-node="mo"><use xlink:href="#MJX-5-TEX-S3-28"/></g><g data-mml-node="mfrac" transform="translate(736, 0)"><g data-mml-node="mrow" transform="translate(220, 676)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-N-394"/></g><g data-mml-node="mi" transform="translate(833, 0)"><use xlink:href="#MJX-5-TEX-I-3D5"/></g></g><g data-mml-node="mn" transform="translate(684.5, -686)"><use xlink:href="#MJX-5-TEX-N-32"/></g><rect width="1629" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(2605, 0)"><use xlink:href="#MJX-5-TEX-S3-29"/></g></g><g data-mml-node="mo" transform="translate(7057.3, 0)"><use xlink:href="#MJX-5-TEX-N-2B"/></g><g data-mml-node="mi" transform="translate(8057.6, 0)"><use xlink:href="#MJX-5-TEX-N-63"/><use xlink:href="#MJX-5-TEX-N-6F" transform="translate(444, 0)"/><use xlink:href="#MJX-5-TEX-N-73" transform="translate(944, 0)"/></g><g data-mml-node="mo" transform="translate(9395.6, 0)"><use xlink:href="#MJX-5-TEX-N-2061"/></g><g data-mml-node="mo" transform="translate(9395.6, 0)"><use xlink:href="#MJX-5-TEX-N-28"/></g><g data-mml-node="msub" transform="translate(9784.6, 0)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-I-3D5"/></g><g data-mml-node="mn" transform="translate(596, -150) scale(0.707)"><use xlink:href="#MJX-5-TEX-N-31"/></g></g><g data-mml-node="mo" transform="translate(10784.1, 0)"><use xlink:href="#MJX-5-TEX-N-29"/></g><g data-mml-node="mo" transform="translate(11395.3, 0)"><use xlink:href="#MJX-5-TEX-N-22C5"/></g><g data-mml-node="mi" transform="translate(11895.6, 0)"><use xlink:href="#MJX-5-TEX-N-63"/><use xlink:href="#MJX-5-TEX-N-6F" transform="translate(444, 0)"/><use xlink:href="#MJX-5-TEX-N-73" transform="translate(944, 0)"/></g><g data-mml-node="mo" transform="translate(13233.6, 0)"><use xlink:href="#MJX-5-TEX-N-2061"/></g><g data-mml-node="mo" transform="translate(13233.6, 0)"><use xlink:href="#MJX-5-TEX-N-28"/></g><g data-mml-node="msub" transform="translate(13622.6, 0)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-I-3D5"/></g><g data-mml-node="mn" transform="translate(596, -150) scale(0.707)"><use xlink:href="#MJX-5-TEX-N-32"/></g></g><g data-mml-node="mo" transform="translate(14622.1, 0)"><use xlink:href="#MJX-5-TEX-N-29"/></g><g data-mml-node="mo" transform="translate(15233.3, 0)"><use xlink:href="#MJX-5-TEX-N-22C5"/></g><g data-mml-node="msup" transform="translate(15733.5, 0)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-N-73"/><use xlink:href="#MJX-5-TEX-N-69" transform="translate(394, 0)"/><use xlink:href="#MJX-5-TEX-N-6E" transform="translate(672, 0)"/></g><g data-mml-node="mn" transform="translate(1228, 413) scale(0.707)"><use xlink:href="#MJX-5-TEX-N-32"/></g></g><g data-mml-node="mo" transform="translate(17365.1, 0)"><use xlink:href="#MJX-5-TEX-N-2061"/></g><g data-mml-node="mrow" transform="translate(17365.1, 0)"><g data-mml-node="mo"><use xlink:href="#MJX-5-TEX-S3-28"/></g><g data-mml-node="mfrac" transform="translate(736, 0)"><g data-mml-node="mrow" transform="translate(220, 676)"><g data-mml-node="mi"><use xlink:href="#MJX-5-TEX-N-394"/></g><g data-mml-node="mi" transform="translate(833, 0)"><use xlink:href="#MJX-5-TEX-I-3BB"/></g></g><g data-mml-node="mn" transform="translate(678, -686)"><use xlink:href="#MJX-5-TEX-N-32"/></g><rect width="1616" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(2592, 0)"><use xlink:href="#MJX-5-TEX-S3-29"/></g></g></g></g></svg></div><p>With:</p><div class=inline-svg-equation style=text-align:left;padding-left:2rem><svg xmlns="http://www.w3.org/2000/svg" width="220.8" height="21.704" viewBox="0 -849.5 12199.1 1199" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-6-TEX-I-63" d="M34 159q0 109 86 196t186 87q56 0 88-24t33-63q0-29-19-49t-48-21q-19 0-30 10t-11 30 11 34 22 21 14 6h1q0 2-6 6t-21 8-34 4q-30 0-57-14-21-9-43-31-44-44-64-124T121 119q0-46 26-69 22-24 58-24h4q112 0 185 85 9 10 12 10 4 0 13-9t10-14-9-15-29-28-45-30T282 0 202-11Q127-11 81 37T34 159z"/><path id="MJX-6-TEX-N-3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/><path id="MJX-6-TEX-N-32" d="M109 429q-27 0-43 18T50 491q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-1e2-92L142 93l76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50V19 31q0 7 6 15T86 81q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/><path id="MJX-6-TEX-N-22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/><path id="MJX-6-TEX-I-61" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27T481 63 449 13Q436 0 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157zM351 328q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111z"/><path id="MJX-6-TEX-I-72" d="M21 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q29 0 51-12t31-22 11-20q2-6 3-6t8 7q48 52 111 52h3q48 0 72-41 8-19 8-37 0-30-13-48t-26-23-25-4q-20 0-32 11t-12 29q0 48 56 64-22 13-36 13-56 0-103-74-10-16-15-33T190 165Q156 25 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 40 172t40 177q0 39-26 39-21 0-36-28T68 316 57 280q-2-2-16-2H27q-6 6-6 9z"/><path id="MJX-6-TEX-I-74" d="M26 385q-7 7-7 10 0 4 3 16t5 14q2 5 9 5t51 1h53l19 80q3 11 7 29t7 26 6 20 8 17 10 12 14 9 18 2q18-1 25-11t7-19q0-7-9-47t-20-79l-10-37q0-2 50-2h51q7-7 7-11 0-22-13-35H210L174 240Q135 80 135 68q0-42 27-42 35 0 68 34t53 84q2 6 5 7t15 2h4q15 0 15-8 0-3-3-12-5-16-18-38T267 48 216 6 155-11Q125-11 98 4T59 56q-2 8-2 27v18L92 241q35 141 36 142 0 2-51 2H26z"/><path id="MJX-6-TEX-I-6E" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157T427 52q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57T508 17 439-10q-47 0-68 27T350 73q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7 74 17q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-1e2-6-20-6-21-2-6-19-6H27q-6 6-6 9z"/><path id="MJX-6-TEX-SO-28" d="M152 251q0 395 236 599h28q6-6 6-9 0-4-19-25t-46-63-55-104-47-167-19-232q0-126 19-231t46-166 55-104 47-64 19-25q0-3-6-9H388q-29 24-56 53t-61 83T212-97 170 56 152 251z"/><path id="MJX-6-TEX-N-221A" d="M95 178q-6 0-14 8t-9 14 31 30 66 50 38 29q2 2 5 2h1q6 0 14-17t54-117q19-43 31-69L397-77q1 0 104 213T707 565 814 786q6 14 20 14 7 0 12-6t7-12v-6L620 293 385-193q-4-7-19-7-9 0-12 3-2 2-98 212L160 225l-16-11q-15-12-31-24T95 178z"/><path id="MJX-6-TEX-N-2C" d="M78 35t0 25 16 43 43 18q28 0 50-25T210 8q0-35-9-68t-21-57-26-41-24-27-13-9q-4 0-13 9t-9 13 11 16 25 30 26 50T173-3V9l-1-1q-2-1-5-2t-6-3-9-2-12-1Q113 0 96 17z"/><path id="MJX-6-TEX-N-31" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-3e2q7-7 12-9t24-4 62-2h26V0H416Q395 3 257 3 121 3 1e2.0H88V46h26q22 0 38 0t25 1 16 3 8 2 6 5 6 4V578z"/><path id="MJX-6-TEX-N-2212" d="M84 237t0 13 14 20H679q15-8 15-20t-15-20H98q-14 7-14 20z"/><path id="MJX-6-TEX-SO-29" d="M305 251q0-396-236-6e2H56q-13 0-17 2t-4 9q2 5 25 31t48 68 52 103T204 27t17 223-17 223-44 163-52 104-48 67-25 32q0 11 15 11h6H69Q197 743 256 566q49-141 49-315z"/></defs><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><use xlink:href="#MJX-6-TEX-I-63"/></g><g data-mml-node="mo" transform="translate(710.8, 0)"><use xlink:href="#MJX-6-TEX-N-3D"/></g><g data-mml-node="mn" transform="translate(1766.6, 0)"><use xlink:href="#MJX-6-TEX-N-32"/></g><g data-mml-node="mo" transform="translate(2488.8, 0)"><use xlink:href="#MJX-6-TEX-N-22C5"/></g><g data-mml-node="mi" transform="translate(2989, 0)"><use xlink:href="#MJX-6-TEX-I-61"/></g><g data-mml-node="mi" transform="translate(3518, 0)"><use xlink:href="#MJX-6-TEX-I-72"/></g><g data-mml-node="mi" transform="translate(3969, 0)"><use xlink:href="#MJX-6-TEX-I-63"/></g><g data-mml-node="mi" transform="translate(4402, 0)"><use xlink:href="#MJX-6-TEX-I-74"/></g><g data-mml-node="mi" transform="translate(4763, 0)"><use xlink:href="#MJX-6-TEX-I-61"/></g><g data-mml-node="mi" transform="translate(5292, 0)"><use xlink:href="#MJX-6-TEX-I-6E"/></g><g data-mml-node="mn" transform="translate(5892, 0)"><use xlink:href="#MJX-6-TEX-N-32"/></g><g data-mml-node="mrow" transform="translate(6392, 0)"><g data-mml-node="mo"><use xlink:href="#MJX-6-TEX-SO-28"/></g><g data-mml-node="msqrt" transform="translate(458, 0)"><g transform="translate(833, 0)"><g data-mml-node="mi"><use xlink:href="#MJX-6-TEX-I-61"/></g></g><g data-mml-node="mo" transform="translate(0, -109.7)"><use xlink:href="#MJX-6-TEX-N-221A"/></g><rect width="529" height="60" x="833" y="630.3"/></g><g data-mml-node="mo" transform="translate(1820, 0)"><use xlink:href="#MJX-6-TEX-N-2C"/></g><g data-mml-node="msqrt" transform="translate(2264.7, 0)"><g transform="translate(833, 0)"><g data-mml-node="mn"><use xlink:href="#MJX-6-TEX-N-31"/></g><g data-mml-node="mo" transform="translate(722.2, 0)"><use xlink:href="#MJX-6-TEX-N-2212"/></g><g data-mml-node="mi" transform="translate(1722.4, 0)"><use xlink:href="#MJX-6-TEX-I-61"/></g></g><g data-mml-node="mo" transform="translate(0, -33.2)"><use xlink:href="#MJX-6-TEX-N-221A"/></g><rect width="2251.4" height="60" x="833" y="706.8"/></g><g data-mml-node="mo" transform="translate(5349.1, 0)"><use xlink:href="#MJX-6-TEX-SO-29"/></g></g></g></g></svg></div><p>and:</p><div class=inline-svg-equation style=text-align:left;padding-left:2rem><svg xmlns="http://www.w3.org/2000/svg" width="68.2" height="14.048" viewBox="0 -694 3768 776" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-7-TEX-I-64" d="M366 683q1 0 72 5t73 6q12 0 12-8 0-7-73-302T375 83t-1-15q0-42 28-42 9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4 4q15 0 15-8 0-5-3-16-13-50-30-81T445 8 417-8q-8-2-24-2-34 0-57 15T306 36l-6 15q-1 1-4-1-2-2-4-4-59-56-120-56-55 0-97 40T33 157q0 48 20 98t48 86q47 57 94 79t85 22q56 0 84-42 5-6 5-4 1 4 27 109t28 111q0 13-7 16t-39 5H357q-6 6-6 8t2 19q5 19 13 19zM352 326q-23 79-75 79-35 0-67-31t-50-81q-29-79-41-164 0-3 0-11t-1-12q0-45 18-62t43-18q54 0 111 72l8 11 54 217z"/><path id="MJX-7-TEX-N-3D" d="M56 347q0 13 14 20H707q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20H708q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/><path id="MJX-7-TEX-I-52" d="M230 637q-27 0-32 1t-5 11q0 27 11 33 2 1 174 1 172-1 186-3 56-8 94-28t54-46 21-43 6-34q0-45-29-84t-67-60-67-34-38-13l7-5q67-38 67-110 0-11-5-61t-5-82V71q0-18 1-28t11-18 26-9q28 0 46 22t26 47q5 14 8 17t15 3q20 0 20-12 0-18-24-57-38-57-90-57h-9Q571-21 531 4T487 82q0 27 15 84t15 73q0 51-43 74-15 7-25 8t-71 2H309L277 193Q244 61 244 59q0-4 1-5t7-4 17-2 33-2h31q6-8 6-9t-3-18Q332 6 326 0H311Q275 2 180 2q-34 0-63 0T71 2 50 1Q33 1 33 10q0 2 3 14 5 19 10 21 4 1 15 1h6q27 0 60 3 14 3 19 12 3 4 72 278t69 289q0 7-57 9zm4e2-83q0 32-21 54t-86 28q-2 0-23 0t-38 1H440q-47 0-54-10-1-3-34-133T319 361q0-1 69-1 78 1 104 7 64 10 1e2 59 16 23 27 60t11 68z"/><path id="MJX-7-TEX-N-22C5" d="M78 250q0 24 17 42t43 18q24 0 42-16t19-43q0-25-17-43t-43-18-43 17-18 43z"/><path id="MJX-7-TEX-I-63" d="M34 159q0 109 86 196t186 87q56 0 88-24t33-63q0-29-19-49t-48-21q-19 0-30 10t-11 30 11 34 22 21 14 6h1q0 2-6 6t-21 8-34 4q-30 0-57-14-21-9-43-31-44-44-64-124T121 119q0-46 26-69 22-24 58-24h4q112 0 185 85 9 10 12 10 4 0 13-9t10-14-9-15-29-28-45-30T282 0 202-11Q127-11 81 37T34 159z"/></defs><g stroke="currentcolor" fill="currentcolor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><use xlink:href="#MJX-7-TEX-I-64"/></g><g data-mml-node="mo" transform="translate(797.8, 0)"><use xlink:href="#MJX-7-TEX-N-3D"/></g><g data-mml-node="mi" transform="translate(1853.6, 0)"><use xlink:href="#MJX-7-TEX-I-52"/></g><g data-mml-node="mo" transform="translate(2834.8, 0)"><use xlink:href="#MJX-7-TEX-N-22C5"/></g><g data-mml-node="mi" transform="translate(3335, 0)"><use xlink:href="#MJX-7-TEX-I-63"/></g></g></g></svg></div><p>Where:</p><p style=padding-left:2rem>Φ = latitude<br>λ = longitude<br><i>R</i> = 6371 (Earth's mean radius in km)<br></p><p>Much of Haverines’ simplicity comes from the underlying assumption that Earth is a perfect sphere (which it isn’t…). Because of this, it can lead to errors of up to 0.5%. More accurate methods exist but at the expense of computational complexity. Below is the Python implementation:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   Nathan A. Rooy</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   Haversine Formula</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#   June, 2016</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>#------------------------------------------------------------------------------+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>math</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>class</span> <span style=color:#0a8;font-weight:700>Haversine</span>:
</span></span><span style=display:flex><span>    <span style=color:#c30>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#c30>    use the haversine class to calculate the distance between
</span></span></span><span style=display:flex><span><span style=color:#c30>    two lon/lat coordnate pairs.
</span></span></span><span style=display:flex><span><span style=color:#c30>    output distance available in kilometers, meters, miles, and feet.
</span></span></span><span style=display:flex><span><span style=color:#c30>    example usage: Haversine([lon1,lat1],[lon2,lat2]).feet
</span></span></span><span style=display:flex><span><span style=color:#c30>    
</span></span></span><span style=display:flex><span><span style=color:#c30>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>def</span> __init__(self,coord1,coord2):
</span></span><span style=display:flex><span>        lon1,lat1<span style=color:#555>=</span>coord1
</span></span><span style=display:flex><span>        lon2,lat2<span style=color:#555>=</span>coord2
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        R<span style=color:#555>=</span><span style=color:#f60>6371000</span>                               <span style=color:#09f;font-style:italic># radius of Earth in meters</span>
</span></span><span style=display:flex><span>        phi_1<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat1)
</span></span><span style=display:flex><span>        phi_2<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        delta_phi<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lat2<span style=color:#555>-</span>lat1)
</span></span><span style=display:flex><span>        delta_lambda<span style=color:#555>=</span>math<span style=color:#555>.</span>radians(lon2<span style=color:#555>-</span>lon1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        a<span style=color:#555>=</span>math<span style=color:#555>.</span>sin(delta_phi<span style=color:#555>/</span><span style=color:#f60>2.0</span>)<span style=color:#555>**</span><span style=color:#f60>2</span><span style=color:#555>+</span>\
</span></span><span style=display:flex><span>           math<span style=color:#555>.</span>cos(phi_1)<span style=color:#555>*</span>math<span style=color:#555>.</span>cos(phi_2)<span style=color:#555>*</span>\
</span></span><span style=display:flex><span>           math<span style=color:#555>.</span>sin(delta_lambda<span style=color:#555>/</span><span style=color:#f60>2.0</span>)<span style=color:#555>**</span><span style=color:#f60>2</span>
</span></span><span style=display:flex><span>        c<span style=color:#555>=</span><span style=color:#f60>2</span><span style=color:#555>*</span>math<span style=color:#555>.</span>atan2(math<span style=color:#555>.</span>sqrt(a),math<span style=color:#555>.</span>sqrt(<span style=color:#f60>1</span><span style=color:#555>-</span>a))
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>meters<span style=color:#555>=</span>R<span style=color:#555>*</span>c                         <span style=color:#09f;font-style:italic># output distance in meters</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>km<span style=color:#555>=</span>self<span style=color:#555>.</span>meters<span style=color:#555>/</span><span style=color:#f60>1000.0</span>              <span style=color:#09f;font-style:italic># output distance in kilometers</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>miles<span style=color:#555>=</span>self<span style=color:#555>.</span>meters<span style=color:#555>*</span><span style=color:#f60>0.000621371</span>      <span style=color:#09f;font-style:italic># output distance in miles</span>
</span></span><span style=display:flex><span>        self<span style=color:#555>.</span>feet<span style=color:#555>=</span>self<span style=color:#555>.</span>miles<span style=color:#555>*</span><span style=color:#f60>5280</span>               <span style=color:#09f;font-style:italic># output distance in feet</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> __name__ <span style=color:#555>==</span> <span style=color:#c30>&#34;__Haversine__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>Example usage:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#555>&gt;&gt;&gt;</span> <span style=color:#069;font-weight:700>import</span> <span style=color:#0cf;font-weight:700>haversine</span>
</span></span><span style=display:flex><span><span style=color:#555>&gt;&gt;&gt;</span> Haversine([<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>],[<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>])<span style=color:#555>.</span>feet 
</span></span><span style=display:flex><span><span style=color:#f60>8.890493621837097</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>feet 
</span></span><span style=display:flex><span><span style=color:#f60>8.890493621837097</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>km 
</span></span><span style=display:flex><span><span style=color:#f60>0.0027098232942902385</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#555>&gt;&gt;&gt;</span> Haversine((<span style=color:#555>-</span><span style=color:#f60>84.412977</span>,<span style=color:#f60>39.152501</span>),(<span style=color:#555>-</span><span style=color:#f60>84.412946</span>,<span style=color:#f60>39.152505</span>))<span style=color:#555>.</span>miles 
</span></span><span style=display:flex><span><span style=color:#f60>0.00168380561019642</span>
</span></span></code></pre></div><p>Note haversine script accepts the coordinates in both tuple “()” and list “[]” form. Additionally, the script can be downloaded from my GitHub located (<a target=_blank href=https://github.com/nathanrooy/spatial-analysis>here</a>).</p></div></div></body></html>